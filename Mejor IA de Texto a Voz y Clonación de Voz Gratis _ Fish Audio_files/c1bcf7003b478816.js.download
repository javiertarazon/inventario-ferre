(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,847451,e=>{"use strict";e.s(["ModelPageProvider",()=>o,"useModelPageContext",()=>n]);var t=e.i(843476),s=e.i(271645),i=e.i(258679),a=e.i(585264),r=e.i(846696);let l=(0,s.createContext)(null);function n(){let e=(0,s.useContext)(l);if(!e)throw Error("useModelPageContext must be used within ModelPageProvider");return e}function o(e){var n,o;let{data:d,children:c}=e,m=(0,a.useTranslations)("discovery"),[x,u]=(0,s.useState)(null!=(n=d.liked)&&n),[h,p]=(0,s.useState)(!1),[g,f]=(0,s.useState)(null!=(o=d.marked)&&o),[v,j]=(0,s.useState)({like:d.like_count,mark:d.mark_count,shared:d.shared_count,task:d.task_count});return(0,s.useEffect)(()=>{var e,t;u(null!=(e=d.liked)&&e),f(null!=(t=d.marked)&&t),j({like:d.like_count,mark:d.mark_count,shared:d.shared_count,task:d.task_count})},[d]),(0,t.jsx)(l.Provider,{value:{data:d,like:x,disliked:h,mark:g,counts:v,handleLike:function(){let e=x?i.unLikeModel:i.likeModel;x?j(e=>({...e,like:e.like-1})):(h&&((0,i.unDislikeModel)({id:d._id}),p(!1)),j(e=>({...e,like:e.like+1}))),u(!x),e({id:d._id}).catch(()=>{u(x),j(e=>({...e,like:x?e.like+1:e.like-1}))})},handleDislike:function(){let e=h?i.unDislikeModel:i.dislikeModel;!h&&x&&((0,i.unLikeModel)({id:d._id}),u(!1),j(e=>({...e,like:e.like-1}))),p(!h),e({id:d._id}).catch(()=>{p(h)})},handleMark:function(){let e=g?i.unMarkModel:i.markModel;g?j(e=>({...e,mark:e.mark-1})):j(e=>({...e,mark:e.mark+1})),f(!g),e({id:d._id}).catch(()=>{f(g),j(e=>({...e,mark:g?e.mark+1:e.mark-1}))})},share:function(){let e="https://fish.audio/m/".concat(d._id);navigator.clipboard.writeText(e),(0,r.toast)(m("copied_title")),(0,i.shareModel)({id:d._id})}},children:c})}},469668,e=>{"use strict";e.s(["ModelProfileHeader",()=>R],469668);var t=e.i(843476),s=e.i(657688),i=e.i(585264),a=e.i(271645);e.i(36095);var r=e.i(114392),l=e.i(647163),n=e.i(87309),o=e.i(571930),d=e.i(248256),c=e.i(790597),m=e.i(158524),x=e.i(270756),u=e.i(662031),h=e.i(160889),p=e.i(4272),g=e.i(653145),f=e.i(994814),v=e.i(50270),j=e.i(952571),b=e.i(531278),y=e.i(846696),w=e.i(969520),N=e.i(602946),k=e.i(581900),_=e.i(710619),C=e.i(462837),M=e.i(129160),T=e.i(689593),D=e.i(23593),S=e.i(774903),I=e.i(847136),F=e.i(258679);let P=[{title:"public",value:"public",description:"public_des"},{title:"unlist",value:"unlist",description:"unlist_des"},{title:"private",value:"private",description:"private_des"}];function L(e){let{open:r,onOpenChange:l,modelId:n,initialData:o}=e,d=(0,i.useTranslations)("train-new-model"),c=(0,i.useTranslations)("m"),m=(0,h.useRouter)(),[x,u]=(0,a.useState)(!1),L=(0,a.useRef)(null),z=(0,a.useRef)(null),A=v.z.object({description:v.z.string(),visibility:v.z.enum(["private","public","unlist"]),cover_image:v.z.instanceof(File).nullable().or(v.z.string()).or(v.z.null()),tags:v.z.array(v.z.string()),confirm_voice_rights:v.z.boolean()}),B=(0,g.useForm)({resolver:(0,f.zodResolver)(A),defaultValues:{description:o.description,visibility:o.visibility,cover_image:o.cover_image,tags:o.tags||[],confirm_voice_rights:!1}});(0,a.useEffect)(()=>{r&&B.reset({description:o.description,visibility:o.visibility,cover_image:o.cover_image,tags:o.tags||[],confirm_voice_rights:!1})},[r,o,B]);let R=B.watch("cover_image"),O=(0,a.useMemo)(()=>{var e;return"string"==typeof R?R:R&&R instanceof Blob&&(null==(e=R.type)?void 0:e.includes("image"))?URL.createObjectURL(R):null},[R]);function E(e){var t;null==(t=z.current)||t.open(e.target.files[0])}function V(e){B.setValue("cover_image",e)}async function H(e){try{u(!0);let{cover_image:t,confirm_voice_rights:s,...i}=e;await (0,F.editModel)(n,{...i,cover_image:"string"==typeof t?void 0:t||void 0}),y.toast.success(c("model_updated")),l(!1),m.refresh()}catch(e){y.toast.error(e.message)}finally{u(!1)}}return(0,t.jsx)(w.Dialog,{open:r,onOpenChange:l,children:(0,t.jsxs)(w.DialogContent,{className:"max-h-[90vh] overflow-y-auto overflow-x-hidden rounded-2xl sm:max-w-xl sm:rounded-2xl",children:[(0,t.jsx)(w.DialogHeader,{children:(0,t.jsx)(w.DialogTitle,{children:c("edit_model")})}),(0,t.jsx)(g.FormProvider,{...B,children:(0,t.jsxs)("form",{onSubmit:B.handleSubmit(H),className:"space-y-6 overflow-hidden",children:[(0,t.jsx)(N.FormField,{control:B.control,name:"cover_image",render:()=>(0,t.jsxs)(N.FormItem,{children:[(0,t.jsx)("div",{className:"text-sm font-medium",children:d("cover-image")}),(0,t.jsxs)("div",{className:"relative mt-2 h-20 w-20 cursor-pointer overflow-hidden rounded-full transition-transform hover:scale-105",onClick:()=>{var e;return null==(e=L.current)?void 0:e.click()},children:[O?(0,t.jsx)(s.default,{src:O,alt:"Cover",fill:!0,className:"object-cover"}):(0,t.jsx)("div",{className:"h-full w-full",style:{background:"conic-gradient(\n                            from 195.7deg at 50% 50%,\n                            #7147ff 0deg,\n                            rgba(66, 232, 255, 0.6) 95.01deg,\n                            rgba(255, 126, 171, 0.5) 185.59deg,\n                            #3083ff 274.88deg,\n                            #7147ff 360deg\n                          )"}}),(0,t.jsx)("input",{ref:L,type:"file",accept:"image/*",onChange:E,className:"hidden"})]}),(0,t.jsx)(I.PictureClip,{ref:z,onFileChange:V}),(0,t.jsx)(N.FormMessage,{})]})}),(0,t.jsx)(N.FormField,{control:B.control,name:"visibility",render:e=>{let{field:s}=e;return(0,t.jsxs)(N.FormItem,{children:[(0,t.jsx)("div",{className:"text-sm font-medium",children:d("type")}),(0,t.jsx)(N.FormControl,{children:(0,t.jsxs)(S.Tabs,{className:"mt-2",value:s.value,onValueChange:s.onChange,children:[(0,t.jsx)(S.TabsList,{className:"mb-0 flex gap-2 border-none bg-transparent p-0 text-muted-foreground",children:P.map(e=>(0,t.jsx)(S.TabsTrigger,{className:"inline-flex h-8 items-center justify-center whitespace-nowrap rounded-full border-none bg-transparent px-4 py-1 text-sm font-normal shadow-none transition-all data-[state=active]:bg-gray-200 data-[state=active]:text-foreground data-[state=active]:shadow-none focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 dark:data-[state=active]:bg-gray-700",value:e.value,children:d(e.title)},e.value))}),P.map(e=>(0,t.jsx)(S.TabsContent,{className:"mt-2 h-8 text-xs text-gray-1",value:e.value,children:d(e.description)},e.value))]})}),(0,t.jsx)(N.FormMessage,{})]})}}),(0,t.jsx)(N.FormField,{control:B.control,name:"description",render:e=>{let{field:s}=e;return(0,t.jsxs)(N.FormItem,{children:[(0,t.jsx)("div",{className:"text-sm font-medium",children:d("description")}),(0,t.jsx)(N.FormControl,{children:(0,t.jsx)(T.AutoHeightTextarea,{className:"mt-1 max-h-32 w-full overflow-y-auto rounded-lg [-ms-overflow-style:none] [scrollbar-width:none] focus-visible:ring-0 focus-visible:ring-offset-0 [&::-webkit-scrollbar]:hidden",placeholder:d("description-placeholder"),...s})}),(0,t.jsx)(N.FormMessage,{})]})}}),(0,t.jsx)(N.FormField,{control:B.control,name:"tags",render:e=>{let{field:s}=e;return(0,t.jsxs)(N.FormItem,{children:[(0,t.jsx)("div",{className:"text-sm font-medium",children:d("tag")}),(0,t.jsx)(N.FormControl,{children:(0,t.jsx)(D.TagInput,{className:"mt-1 w-full overflow-hidden rounded-lg focus-visible:ring-0 focus-visible:ring-offset-0",placeholder:d("tag-placeholder"),value:s.value,onChange:s.onChange})}),(0,t.jsx)(N.FormMessage,{})]})}}),(0,t.jsx)("div",{className:"public"!==B.watch("visibility")?"invisible":"",children:(0,t.jsx)(N.FormField,{control:B.control,name:"confirm_voice_rights",render:e=>{let{field:s}=e;return(0,t.jsx)(N.FormItem,{className:"space-y-2",children:(0,t.jsxs)("div",{className:"flex flex-row items-center space-x-3",children:[(0,t.jsx)(N.FormControl,{children:(0,t.jsx)(k.Checkbox,{checked:s.value,onCheckedChange:s.onChange})}),(0,t.jsxs)("div",{className:"flex items-center gap-1.5 leading-none",children:[(0,t.jsxs)(_.Label,{className:"cursor-pointer text-sm font-normal text-muted-foreground",onClick:()=>s.onChange(!s.value),children:[d("confirmVoiceRights")," ",(0,t.jsx)("span",{className:"italic",children:d("form-error.confirm_voice_rights_required")})]}),(0,t.jsx)(C.TooltipProvider,{children:(0,t.jsxs)(C.Tooltip,{children:[(0,t.jsx)(C.TooltipTrigger,{asChild:!0,children:(0,t.jsx)(j.Info,{className:"ml-1 hidden h-4 w-4 text-muted-foreground md:block"})}),(0,t.jsx)(C.TooltipContent,{side:"top",align:"end",className:"max-w-xs",children:(0,t.jsx)("p",{children:d.rich("confirmVoiceRightsTooltip",{termsLink:e=>(0,t.jsx)("a",{href:"https://fish.audio/terms",target:"_blank",rel:"noopener noreferrer",className:"text-primary underline hover:text-primary/80",children:e}),privacyLink:e=>(0,t.jsx)("a",{href:"https://fish.audio/privacy",target:"_blank",rel:"noopener noreferrer",className:"text-primary underline hover:text-primary/80",children:e})})})})]})}),(0,t.jsxs)(M.Popover,{children:[(0,t.jsx)(M.PopoverTrigger,{asChild:!0,children:(0,t.jsx)(j.Info,{className:"ml-1 h-4 w-4 text-muted-foreground md:hidden"})}),(0,t.jsx)(M.PopoverContent,{side:"top",align:"end",className:"max-w-xs text-sm",children:(0,t.jsx)("p",{children:d.rich("confirmVoiceRightsTooltip",{termsLink:e=>(0,t.jsx)("a",{href:"https://fish.audio/terms",target:"_blank",rel:"noopener noreferrer",className:"text-primary underline hover:text-primary/80",children:e}),privacyLink:e=>(0,t.jsx)("a",{href:"https://fish.audio/privacy",target:"_blank",rel:"noopener noreferrer",className:"text-primary underline hover:text-primary/80",children:e})})})})]})]})]})})}})}),(0,t.jsxs)("div",{className:"flex justify-end gap-3 pt-2",children:[(0,t.jsx)(p.Button,{type:"button",variant:"outline",onClick:()=>l(!1),className:"rounded-xl",children:c("cancel")}),(0,t.jsxs)(p.Button,{type:"submit",disabled:x||"public"===B.watch("visibility")&&!B.watch("confirm_voice_rights"),className:"rounded-xl",children:[x&&(0,t.jsx)(b.Loader2,{className:"mr-2 h-4 w-4 animate-spin"}),c("save")]})]})]})})]})})}var z=e.i(847451),A=e.i(192049),B=e.i(162353);let R=e=>{var g,f;let{data:v,isOwner:j=!1}=e,b=(0,i.useTranslations)("m"),y=(0,i.useTranslations)("train-new-model.suggested-tags"),w=(0,i.useTranslations)("train-new-model"),N=(0,i.useLocale)(),[k,_]=(0,a.useState)(!1),{counts:C}=(0,z.useModelPageContext)(),M=[{icon:n.AudioLines,labelKey:"uses",value:C.task},{icon:u.Share2,labelKey:"shares",value:C.shared},{icon:c.Heart,labelKey:"likes",value:C.like},{icon:o.Bookmark,labelKey:"saved_by",value:C.mark}];return(0,t.jsxs)("div",{className:"flex flex-col gap-6",children:[(0,t.jsxs)("div",{className:"flex gap-6 md:gap-8",children:[(0,t.jsx)("div",{className:"flex-shrink-0",children:(0,t.jsx)(s.default,{className:"h-20 w-20 rounded-full object-cover md:h-32 md:w-32",src:(0,l.fetchImage)(v.cover_image),alt:v.title,width:128,height:128})}),(0,t.jsxs)("div",{className:"flex min-w-0 flex-1 flex-col justify-center gap-3",children:[(0,t.jsxs)("div",{className:"flex min-w-0 items-start justify-between gap-2",children:[(0,t.jsx)("h1",{className:"min-w-0 flex-1 text-xl [overflow-wrap:anywhere] md:text-2xl",children:v.title}),j&&(0,t.jsx)(p.Button,{variant:"ghost",size:"sm",onClick:()=>_(!0),className:"rounded-full text-sm text-std-text-secondary hover:bg-transparent hover:text-std-text-primary",children:b("edit_model")})]}),(0,t.jsxs)(h.Link,{href:"/u/".concat(v.author._id),className:"text-sm text-std-text-secondary hover:underline",children:["@",v.author.nickname]}),(0,t.jsx)("div",{className:"flex flex-wrap gap-x-4 gap-y-1 md:gap-6",children:M.map((e,s)=>(0,t.jsxs)("div",{className:"flex items-center gap-1.5",children:[(0,t.jsx)(r.default,{value:e.value,format:{notation:"compact"},locales:N,className:"font-semibold"}),(0,t.jsx)("span",{className:"text-sm text-std-text-secondary",children:b(e.labelKey)})]},s))})]})]}),v.description&&(0,t.jsx)("p",{className:"break-words text-sm leading-relaxed text-std-text-primary",children:v.description}),(0,t.jsxs)("div",{className:"flex items-center justify-between gap-4",children:[(0,t.jsxs)("div",{className:"flex flex-wrap items-center gap-2",children:[null==(g=v.languages)?void 0:g.map((e,s)=>(0,t.jsx)("span",{className:"rounded-full bg-primary/10 px-3 py-1 text-xs font-medium text-primary",children:e},"lang-".concat(s))),null==(f=v.tags)?void 0:f.map((e,s)=>(0,t.jsx)("span",{className:"rounded-full bg-std-bg-elevated px-3 py-1 text-xs text-std-text-secondary",children:(0,B.getTagLabel)(e,y)},"tag-".concat(s)))]}),(0,t.jsxs)("div",{className:"flex flex-shrink-0 items-center gap-3",children:[(0,t.jsxs)("div",{className:"flex items-center gap-1 text-xs text-std-text-secondary",children:["public"===v.visibility&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(d.Globe,{className:"h-3.5 w-3.5"}),(0,t.jsx)("span",{children:w("public")})]}),"private"===v.visibility&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(x.Lock,{className:"h-3.5 w-3.5"}),(0,t.jsx)("span",{children:w("private")})]}),"unlist"===v.visibility&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(m.Link2,{className:"h-3.5 w-3.5"}),(0,t.jsx)("span",{children:w("unlist")})]})]}),(0,t.jsx)(A.TimeLineDate,{time:v.created_at,spanClassName:"text-xs text-std-text-secondary"})]})]}),j&&(0,t.jsx)(L,{open:k,onOpenChange:_,modelId:v._id,initialData:{description:v.description||"",visibility:v.visibility,cover_image:v.cover_image?(0,l.fetchImage)(v.cover_image):null,tags:v.tags||[]}})]})}},999467,e=>{"use strict";e.s(["SamplesEditor",()=>_],999467);var t=e.i(843476),s=e.i(585264),i=e.i(271645),a=e.i(501859),r=e.i(647163),l=e.i(653860),n=e.i(689593),o=e.i(462837),d=e.i(758e3),c=e.i(531278),m=e.i(107233),x=e.i(251854),x=x,u=e.i(572226),h=e.i(4272),p=e.i(465061),g=e.i(74455),f=e.i(846696),v=e.i(100574),j=e.i(258679),b=e.i(941855);let y=(0,i.createContext)({modelId:"",samples:new Map,setSamples:()=>{},keys:[],setKeys:()=>{},loadingStates:{},setLoadingState:()=>{},deleteItem:()=>{},appendEmpty:()=>{},isOwner:!1,isEditing:!1});function w(){return Math.floor(1e6*Math.random())+""}function N(e){let{className:l,onClick:n,loading:m,isRegenerate:x}=e,u=(0,s.useTranslations)("train-new-model"),[p,g]=(0,i.useState)(!1);return(0,t.jsx)(o.TooltipProvider,{children:(0,t.jsxs)(o.Tooltip,{open:p,onOpenChange:g,children:[(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsxs)(h.Button,{variant:"ghost",disabled:m,onClick:n,className:"gap-2 rounded-full bg-primary/10 px-4 py-2 text-sm font-normal hover:bg-primary/20",children:[m?(0,t.jsx)(c.Loader2,{className:"h-4 w-4 animate-spin"}):(0,t.jsx)(a.RiAiGenerate,{className:(0,r.cn)("h-4 w-4",l)}),u(x?"regenerate_sample":"generate_sample")]}),(0,t.jsx)(o.TooltipTrigger,{children:(0,t.jsx)(d.CircleHelp,{className:"h-4 w-4 text-muted-foreground"})})]}),(0,t.jsx)(o.TooltipContent,{children:(0,t.jsx)("div",{className:"flex justify-between",children:u("generator_audio_tips")})})]})})}function k(e){let{index:a,dataKey:o,className:d,...c}=e,m=(0,s.useTranslations)("train-new-model"),{isCN:x}=(0,b.useEnvironment)(),{modelId:h,samples:j,setSamples:w,deleteItem:k,setLoadingState:_,isEditing:C}=(0,i.useContext)(y),[M,T]=(0,i.useState)(!1),D=j.get(o)||{title:"",text:"",task_id:"",audio:""},S=D.audio?(0,r.formatAudioUrl)(D.audio,x):null,I=(e,t)=>{w(s=>{let i=new Map(s),a=i.get(o)||{title:"",text:"",task_id:"",audio:""};return i.set(o,{...a,[e]:t}),i})};async function F(){if(!D.text.trim())return void f.toast.error(m("form-error.samples_text_text_length"));try{T(!0),_(o,!0);let e=await (0,v.getReCaptchaToken)("playground"),t=await (0,p.createTTSTask)({model:h,text:D.text,recaptcha:e,latency:"normal"});w(e=>{let s=new Map(e),i=s.get(o)||{title:"",text:"",task_id:"",audio:""};return s.set(o,{...i,task_id:t.taskId,audio:t.audio}),s})}catch(e){f.toast.error(e.message)}finally{T(!1),_(o,!1)}}return(0,t.jsxs)("div",{className:(0,r.cn)("py-4",d),"data-key":o,...c,children:[(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsx)("span",{className:"font-medium",children:D.title||m("sample_title",{index:a+1})}),C&&(0,t.jsx)("button",{type:"button",onClick:function(){k(o)},className:"p-1.5 text-std-text-secondary hover:text-std-text-primary",children:(0,t.jsx)(u.Cross1Icon,{className:"h-4 w-4"})})]}),(0,t.jsxs)("div",{className:"mt-3 space-y-3",children:[C?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(l.Input,{placeholder:m("audio_sample_title"),className:"rounded-lg border-std-border-base bg-std-bg-base focus-visible:ring-1 focus-visible:ring-primary",value:D.title,onChange:e=>I("title",e.target.value)}),(0,t.jsx)(n.AutoHeightTextarea,{placeholder:m("audio_sample_text"),className:"rounded-lg border-std-border-base bg-std-bg-base focus-visible:ring-1 focus-visible:ring-primary",value:D.text,onChange:e=>I("text",e.target.value)})]}):D.text&&(0,t.jsx)("p",{className:"text-sm leading-relaxed text-std-text-secondary",children:D.text}),(0,t.jsxs)("div",{children:[M&&(0,t.jsx)("div",{className:"py-2 text-center text-sm text-muted-foreground",children:m("loading_audio")}),!M&&S&&(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[(0,t.jsx)("div",{className:"flex-1",children:(0,t.jsx)(g.default,{src:S,hiddenVolumn:!0})}),C&&(0,t.jsx)(N,{loading:M,onClick:F,isRegenerate:!0})]}),!M&&!S&&C&&(0,t.jsx)(N,{loading:M,onClick:F})]})]})]})}function _(e){let{modelId:a,initialSamples:l,isOwner:n=!1,className:o,...d}=e,u=(0,s.useTranslations)("train-new-model"),p=(0,s.useTranslations)("m"),[g,v]=(0,i.useState)([]),[b,N]=(0,i.useState)(new Map),[_,C]=(0,i.useState)({}),[M,T]=(0,i.useState)(!1),[D,S]=(0,i.useState)(""),[I,F]=(0,i.useState)(!1),P=()=>JSON.stringify(g.map(e=>{let t=b.get(e);return{title:(null==t?void 0:t.title)||"",text:(null==t?void 0:t.text)||"",task_id:(null==t?void 0:t.task_id)||""}})),L=""!==D&&P()!==D;function z(){let e=w();v(t=>[...t,e]),N(t=>{let s=new Map(t);return s.set(e,{title:"",text:"",task_id:"",audio:""}),s})}async function A(){if(Object.values(_).some(e=>e))return void f.toast.error(u("audio_generating"));let e=g.map(e=>{let t=b.get(e);return{title:(null==t?void 0:t.title)||"",text:(null==t?void 0:t.text)||"",audio_id:(null==t?void 0:t.task_id)||""}});try{T(!0),await (0,j.editModelSample)({id:a,samples:e}),f.toast.success(p("samples_saved")),S(P()),F(!1)}catch(e){f.toast.error(e.message)}finally{T(!1)}}return(0,i.useEffect)(()=>{let e=[],t=new Map;l.forEach(s=>{let i=w();e.push(i),t.set(i,s)}),v(e),N(t),S(JSON.stringify(l.map(e=>({title:e.title||"",text:e.text||"",task_id:e.task_id||""}))))},[l]),(0,t.jsx)(y.Provider,{value:{modelId:a,samples:b,setSamples:N,keys:g,setKeys:v,loadingStates:_,setLoadingState:function(e,t){C(s=>({...s,[e]:t}))},deleteItem:function(e){v(t=>t.filter(t=>t!==e)),N(t=>{let s=new Map(t);return s.delete(e),s})},appendEmpty:z,isOwner:n,isEditing:I},children:(0,t.jsxs)("div",{className:(0,r.cn)("",o),...d,children:[(0,t.jsxs)("div",{className:"flex items-center justify-between border-b border-std-border-base pb-3",children:[(0,t.jsx)("span",{className:"text-sm font-semibold uppercase tracking-wide text-std-text-secondary",children:p("samples")}),n&&!I&&(0,t.jsx)(h.Button,{variant:"ghost",size:"sm",onClick:()=>F(!0),className:"rounded-full text-sm text-std-text-secondary hover:bg-transparent hover:text-std-text-primary",children:p("edit_samples")}),n&&I&&(0,t.jsx)(h.Button,{variant:"ghost",size:"sm",onClick:function(){let e=[],t=new Map;l.forEach(s=>{let i=w();e.push(i),t.set(i,s)}),v(e),N(t),F(!1)},className:"rounded-full text-sm text-std-text-secondary hover:bg-transparent hover:text-std-text-primary",children:p("cancel")})]}),(0,t.jsxs)("div",{className:"mt-4 flex flex-col divide-y divide-std-border-base",children:[0===g.length&&!I&&(0,t.jsx)("div",{className:"py-8 text-center text-sm text-std-text-secondary",children:p("no_audio_sample_tips")}),g.map((e,s)=>(0,t.jsx)(k,{dataKey:e,index:s},e))]}),I&&(0,t.jsxs)("div",{className:"mt-4 flex flex-col gap-3",children:[(0,t.jsxs)(h.Button,{type:"button",variant:"outline",onClick:z,className:"w-full gap-2 rounded-full py-3 text-sm font-normal",children:[(0,t.jsx)(m.Plus,{className:"h-4 w-4"}),u("add_audio_sample")]}),(0,t.jsxs)(h.Button,{onClick:A,disabled:M||!L,className:"w-full gap-2 rounded-full py-3",children:[M?(0,t.jsx)(c.Loader2,{className:"h-4 w-4 animate-spin"}):(0,t.jsx)(x.default,{className:"h-4 w-4"}),p("save")]})]})]})})}},158697,e=>{"use strict";e.s(["DashboardVoiceButtonGroups",()=>A],158697);var t=e.i(843476),s=e.i(64402),s=s,i=e.i(87309),a=e.i(707621),r=e.i(14),l=e.i(495185),n=e.i(639125),o=e.i(541071),d=e.i(788699),c=e.i(662031),m=e.i(365582),x=e.i(400417),u=e.i(727612),h=e.i(271645),p=e.i(846696),g=e.i(585264),f=e.i(258679),v=e.i(647163),j=e.i(639499),b=e.i(941855),y=e.i(64585),w=e.i(129668),N=e.i(160889),k=e.i(168202),_=e.i(918871),C=e.i(8553),M=e.i(784273),T=e.i(847451),D=e.i(999445),S=e.i(4272),I=e.i(681846),F=e.i(514485),P=e.i(86303),L=e.i(419751),z=e.i(522016);let A=e=>{let{className:A,data:B,...R}=e,O=(0,g.useTranslations)("discovery"),E=(0,g.useTranslations)("m"),{isCN:V}=(0,b.useEnvironment)(),{user:H,hasLogin:K}=(0,y.useUser)(),{userPackage:U}=(0,w.usePackage)(),G=(0,N.useRouter)(),{counts:J}=(0,k.useVoiceCounts)(),[q,Q]=(0,h.useState)(!1),[W,X]=(0,h.useState)(!1),[Y,Z]=(0,h.useState)(!1),[$,ee]=(0,h.useState)(!1),[et,es]=(0,h.useState)("private_limit_reached"),{like:ei,disliked:ea,mark:er,handleLike:el,handleDislike:en,handleMark:eo,share:ed}=(0,T.useModelPageContext)(),ec=async()=>{(await (0,f.cloneModel)({id:B._id})).ok?p.toast.success(O("clone_success")):p.toast.error(O("clone_failed")),X(!1)},em=async()=>{if(!await confirm("Are you sure you want to hide this model?"))return void p.toast.info("Operation cancelled");try{await (0,f.modifyModel)({id:B._id,visibility:"private"}),p.toast.info("Model has been marked as private")}catch(e){p.toast.error(e.message)}};return(0,t.jsxs)("div",{className:(0,v.cn)("flex flex-col gap-3",A),...R,children:[(0,t.jsxs)("div",{className:"flex gap-3",children:[(0,t.jsxs)(z.default,{href:(0,j.getDashboardInstantSpeechUrl)(B._id),className:"flex min-w-0 flex-1 items-center justify-center gap-2 rounded-xl bg-primary px-4 py-2.5 text-primary-foreground shadow-sm transition-colors hover:bg-primary/90",children:[(0,t.jsx)(i.AudioLines,{className:"h-4 w-4 flex-shrink-0"}),(0,t.jsx)("span",{className:"text-sm font-medium",children:O("use_voice")})]}),(0,t.jsxs)(S.Button,{size:"sm",variant:"outline",onClick:eo,className:"flex min-w-0 flex-1 items-center justify-center gap-2 rounded-xl px-4",children:[(0,t.jsx)(D.Bookmark,{className:(0,v.cn)("h-4 w-4 flex-shrink-0",""),fillIcon:er}),E("bookmark")]}),(0,t.jsxs)(I.DropdownMenu,{modal:!1,children:[(0,t.jsx)(I.DropdownMenuTrigger,{asChild:!0,children:(0,t.jsx)(S.Button,{size:"sm",variant:"ghost",className:"flex cursor-pointer items-center justify-center px-1 hover:bg-transparent","aria-label":"More actions",title:"More actions",children:(0,t.jsx)(o.MoreHorizontal,{className:"h-5 w-5"})})}),(0,t.jsx)(I.DropdownMenuPortal,{children:(0,t.jsxs)(I.DropdownMenuContent,{className:"rounded-xl border border-std-border-base bg-std-bg-base shadow-lg",align:"end",children:[(0,t.jsx)(P.CollectionAdditionDialog,{modelId:B._id,isDashboard:!0,triggerChildren:(0,t.jsxs)(I.DropdownMenuItem,{className:"cursor-pointer gap-3",onSelect:e=>e.preventDefault(),children:[(0,t.jsx)(n.ListPlus,{className:"h-4 w-4 text-gray-1"}),(0,t.jsx)("span",{children:O("add_to_collection_action")})]})}),!V&&(0,t.jsxs)(I.DropdownMenuItem,{className:"cursor-pointer gap-3",onClick:ed,children:[(0,t.jsx)(c.Share2,{className:"h-4 w-4 text-gray-1"}),(0,t.jsx)("span",{children:E("share")})]}),(0,t.jsxs)(I.DropdownMenuItem,{className:"cursor-pointer gap-3",onClick:el,children:[(0,t.jsx)(x.ThumbsUp,{className:(0,v.cn)("h-4 w-4",ei?"text-red":"text-gray-1"),fill:ei?"currentColor":"none"}),(0,t.jsx)("span",{children:E("like")})]}),(0,t.jsxs)(I.DropdownMenuItem,{className:"cursor-pointer gap-3",onClick:en,children:[(0,t.jsx)(m.ThumbsDown,{className:(0,v.cn)("h-4 w-4",ea?"text-red-500":"text-gray-1"),fill:ea?"currentColor":"none"}),(0,t.jsx)("span",{children:E("dislike")})]}),(0,t.jsxs)(I.DropdownMenuItem,{className:"cursor-pointer gap-3",onClick:()=>{if(!K)return void G.push("/auth");let e=(0,_.canCreateVoice)(null==U?void 0:U.type,"private",J);if(!e.allowed){es(e.reason),ee(!0);return}X(!0)},children:[(0,t.jsx)(l.CopyPlus,{className:"h-4 w-4 text-gray-1"}),(0,t.jsx)("span",{children:O("clone_model")})]}),(0,t.jsxs)(I.DropdownMenuItem,{className:"cursor-pointer gap-3",onClick:()=>{navigator.clipboard.writeText("".concat(B._id)),(0,p.toast)(O("copied_title"))},children:[(0,t.jsx)(r.ClipboardCopy,{className:"h-4 w-4 text-gray-1"}),(0,t.jsx)("span",{children:O("copy_model_id")})]}),(0,t.jsxs)(I.DropdownMenuItem,{className:"cursor-pointer gap-3",onClick:()=>Q(!0),children:[(0,t.jsx)(a.CircleAlert,{className:"h-4 w-4 text-gray-1"}),(0,t.jsx)("span",{children:O("report.title")})]})]})})]})]}),(null==H?void 0:H.role)==="admin"&&(0,t.jsx)("div",{className:"flex gap-3",children:(0,t.jsxs)(I.DropdownMenu,{modal:!1,children:[(0,t.jsx)(I.DropdownMenuTrigger,{asChild:!0,children:(0,t.jsxs)(S.Button,{size:"sm",variant:"secondary",className:"rounded-xl","aria-label":"Admin actions",title:"Admin actions",children:["管理",(0,t.jsx)(o.MoreHorizontal,{className:"ml-2 h-4 w-4"})]})}),(0,t.jsx)(I.DropdownMenuPortal,{children:(0,t.jsxs)(I.DropdownMenuContent,{className:"border-white/8 rounded-lg border bg-gradient-to-b from-std-bg-elevated to-std-bg-card shadow-[0px_1px_1px_0px_rgba(14,14,17,0.04),0px_2px_4px_0px_rgba(14,14,17,0.04)]",align:"start",children:[(0,t.jsx)(I.DropdownMenuItem,{asChild:!0,children:(0,t.jsxs)(z.default,{className:"flex cursor-pointer items-center",href:"/app/m/".concat(B._id,"/edit"),"aria-label":"Edit voice model",title:"Edit voice model",children:[(0,t.jsx)("div",{className:"flex h-8 w-8 items-center justify-center rounded-md bg-gray-4 dark:bg-white/10",children:(0,t.jsx)(d.Pencil,{className:"w-4 text-gray-1"})}),(0,t.jsx)("span",{className:"ml-4",children:"编辑模型"})]})}),(0,t.jsx)(I.DropdownMenuItem,{asChild:!0,children:(0,t.jsxs)(z.default,{href:"".concat("https://platform.r2.fish.audio/train-data/").concat(B._id),target:"_blank",className:"flex cursor-pointer items-center","aria-label":"Download data",title:"Download data",children:[(0,t.jsx)("div",{className:"flex h-8 w-8 items-center justify-center rounded-md bg-gray-4 dark:bg-white/10",children:(0,t.jsx)(s.default,{className:"w-4 text-gray-1"})}),(0,t.jsx)("span",{className:"ml-4",children:"下载数据"})]})}),(0,t.jsxs)(I.DropdownMenuItem,{className:"cursor-pointer",onClick:em,"aria-label":"Hide model",title:"Hide model",children:[(0,t.jsx)("div",{className:"flex h-8 w-8 items-center justify-center rounded-md bg-gray-4 dark:bg-white/10",children:(0,t.jsx)(a.CircleAlert,{className:"w-4 text-destructive"})}),(0,t.jsx)("span",{className:"ml-4 text-destructive",children:"隐藏此模型"})]}),(0,t.jsxs)(I.DropdownMenuItem,{className:"cursor-pointer",onClick:()=>Z(!0),"aria-label":"Delete model",title:"Delete model",children:[(0,t.jsx)("div",{className:"flex h-8 w-8 items-center justify-center rounded-md bg-gray-4 dark:bg-white/10",children:(0,t.jsx)(u.Trash2,{className:"w-4 text-destructive"})}),(0,t.jsx)("span",{className:"ml-4 text-destructive",children:"删除模型"})]})]})})]})}),(0,t.jsx)(F.CloneModelDialog,{open:W,onOpenChange:X,onConfirm:ec}),(0,t.jsx)(M.ReportModel,{link:"https://fish.audio/m/".concat(B._id),open:q,onOpenChange:Q}),(0,t.jsx)(L.DelModelDialog,{id:B._id,confirmDelete:Y,setConfirmDelete:Z,onDeleted:()=>{window.location.reload()}}),(0,t.jsx)(C.VoiceSlotUpgradeModal,{open:$,onOpenChange:ee,reason:et,currentCounts:J})]})}},35723,e=>{"use strict";e.s(["RelatedModels",()=>l]);var t=e.i(843476),s=e.i(522016),i=e.i(585264),a=e.i(200997),r=e.i(647163);let l=e=>{let{className:l,models:n,isDashboard:o=!1,variant:d="card"}=e,c=(0,i.useTranslations)("m");return 0===n.length?null:(0,t.jsxs)("div",{className:(0,r.cn)("flex flex-col gap-3","card"===d?"border-white/8 rounded-[20px] border bg-std-bg-base p-6 dark:bg-gradient-to-t dark:from-std-bg-elevated dark:to-std-bg-base dark:shadow-[0px_-1px_20px_0px_rgba(0,0,0,0.25)_inset]":"",l),children:[(0,t.jsx)("h3",{className:(0,r.cn)("text-std-text-secondary","flat"===d?"border-b border-std-border-base pb-3 text-sm font-semibold uppercase tracking-wide":"font-medium"),children:c("explore-related-models")}),(0,t.jsx)("div",{className:(0,r.cn)("grid gap-3","flat"===d?"grid-cols-4 md:grid-cols-6":"grid-cols-3 gap-1.5"),children:n.slice(0,"flat"===d?12:9).map(e=>(0,t.jsxs)(s.default,{href:o?"/app/m/".concat(e._id):"/m/".concat(e._id),className:(0,r.cn)("flex flex-col items-center justify-center gap-2 rounded-lg p-2 transition-colors hover:bg-std-bg-elevated","card"===d&&"max-w-24 gap-1.5 p-1.5 hover:bg-white/10"),children:[(0,t.jsxs)(a.Avatar,{className:(0,r.cn)("rounded-full","flat"===d?"h-12 w-12 md:h-14 md:w-14":"h-7 w-7 rounded-lg"),children:[(0,t.jsx)(a.AvatarImage,{src:(0,r.fetchImage)(e.cover_image,128),alt:e.title,loading:"lazy"}),(0,t.jsx)(a.AvatarFallback,{className:"text-xs",children:e.title.slice(0,2)})]}),(0,t.jsx)("span",{className:(0,r.cn)("line-clamp-1 text-center text-std-text-basic","text-xs"),children:e.title})]},e._id))})]})}}]);