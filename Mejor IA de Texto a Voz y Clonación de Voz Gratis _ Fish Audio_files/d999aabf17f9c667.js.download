(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,672345,e=>{"use strict";e.s(["addModelToCollection",()=>o,"createVoiceCollection",()=>s,"deleteCollectionModel",()=>l,"deleteVoiceCollection",()=>r,"followCollection",()=>c,"getCollectionModels",()=>n,"listVoiceCollection",()=>a,"unfollowCollection",()=>d,"updateVoiceCollection",()=>i]);var t=e.i(100574);let s=t.fetcher.path("/collection").method("post").create(),a=t.fetcher.path("/collection").method("get").create();t.fetcher.path("/collection/{id}").method("get").create(),t.fetcher.path("/collection/{id}").method("get").create();let i=t.fetcher.path("/collection/{id}").method("put").create(),r=t.fetcher.path("/collection/{id}").method("delete").create(),n=t.fetcher.path("/collection/{id}/models").method("get").create(),l=t.fetcher.path("/collection/{id}/models/{model_id}").method("delete").create(),o=t.fetcher.path("/collection/{id}/models/{model_id}").method("post").create(),c=t.fetcher.path("/collection/{id}/follow").method("post").create(),d=t.fetcher.path("/collection/{id}/follow").method("delete").create()},495242,361839,e=>{"use strict";e.s(["Pause",()=>t],495242),e.s(["default",()=>t],361839);let t=(0,e.i(475254).default)("pause",[["rect",{x:"14",y:"3",width:"5",height:"18",rx:"1",key:"kaeet6"}],["rect",{x:"5",y:"3",width:"5",height:"18",rx:"1",key:"1wsw3u"}]])},431343,451477,e=>{"use strict";e.s(["Play",()=>t],431343),e.s(["default",()=>t],451477);let t=(0,e.i(475254).default)("play",[["path",{d:"M5 5a2 2 0 0 1 3.008-1.728l11.997 6.998a2 2 0 0 1 .003 3.458l-12 7A2 2 0 0 1 5 19z",key:"10ikf1"}]])},541071,373488,e=>{"use strict";e.s(["MoreHorizontal",()=>t],541071),e.s(["default",()=>t],373488);let t=(0,e.i(475254).default)("ellipsis",[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"19",cy:"12",r:"1",key:"1wjl8i"}],["circle",{cx:"5",cy:"12",r:"1",key:"1pcz8c"}]])},730062,e=>{"use strict";e.s(["Badge",()=>r]);var t=e.i(843476),s=e.i(225913),a=e.i(647163);let i=(0,s.cva)("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground"},type:{outline:"rounded-md",square:"rounded-md",circle:"rounded-full","outline-circle":"rounded-full"},theme:{default:"",info:"bg-badge-info-ground text-badge-info-text hover:bg-info-ground",blue:"bg-badge-blue-ground text-badge-blue-text hover:bg-blue-ground",destructive:"bg-badge-destructive-ground text-badge-destructive-text hover:bg-destructive-ground",success:"bg-badge-success-ground text-badge-success-text hover:bg-success-ground"}},compoundVariants:[{theme:"blue",type:["outline","outline-circle"],class:"border-badge-blue-border border bg-badge-blue-outlineground text-badge-blue-outlinetext hover:bg-blue-outlineground"},{theme:"success",type:["outline","outline-circle"],class:"border-badge-success-border border bg-badge-success-outlineground text-badge-success-outlinetext hover:bg-success-outlineground"},{theme:"destructive",type:["outline","outline-circle"],class:"border-badge-destructive-border border bg-badge-destructive-outlineground text-badge-destructive-outlinetext hover:bg-destructive-outlineground"},{theme:"info",type:["outline","outline-circle"],class:"border-badge-info-border border bg-badge-info-outlineground text-badge-info-outlinetext hover:bg-info-outlineground"}],defaultVariants:{variant:"default",type:"circle"}});function r(e){let{className:s,variant:r,type:n,theme:l,...o}=e;return(0,t.jsx)("div",{className:(0,a.cn)(i({variant:r,type:n,theme:l}),s),...o})}},245046,e=>{"use strict";e.s(["Heart",()=>s]);var t=e.i(843476);function s(e){let{fillIcon:s,...a}=e;return(0,t.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 20 20",...a,children:(0,t.jsx)("path",{d:"M6.24984 3.33325C3.71859 3.33325 1.6665 5.38534 1.6665 7.91659C1.6665 12.4999 7.08317 16.6666 9.99984 17.6358C12.9165 16.6666 18.3332 12.4999 18.3332 7.91659C18.3332 5.38534 16.2811 3.33325 13.7498 3.33325C12.1998 3.33325 10.829 4.10284 9.99984 5.28075C9.5772 4.67876 9.01574 4.18746 8.36298 3.84846C7.71021 3.50945 6.98538 3.33273 6.24984 3.33325Z",stroke:"currentColor",fill:s?"currentColor":"none",strokeWidth:"1.66667",strokeLinecap:"round",strokeLinejoin:"round"})})}},513959,e=>{"use strict";e.s(["HeartCrack",()=>s,"HeartCrackIcon",()=>a]);var t=e.i(843476);function s(e){let{fillIcon:s,...a}=e;return(0,t.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:s?"currentColor":"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...a,children:[(0,t.jsx)("path",{d:"M19 14c1.49-1.46 3-3.21 3-5.5A5.5 5.5 0 0 0 16.5 3c-1.76 0-3 .5-4.5 2-1.5-1.5-2.74-2-4.5-2A5.5 5.5 0 0 0 2 8.5c0 2.3 1.5 4.05 3 5.5l7 7Z"}),(0,t.jsx)("path",{d:"m12 13-1-1 2-2-3-3 2-2",className:s?"stroke-white dark:stroke-black":"stroke-gray-1"})]})}function a(e){let{fillIcon:s,...a}=e;return(0,t.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",...a,children:[(0,t.jsx)("path",{d:"M12.6666 9.33333C13.6599 8.36 14.6666 7.19333 14.6666 5.66667C14.6666 4.69421 14.2803 3.76158 13.5926 3.07394C12.905 2.38631 11.9724 2 10.9999 2C9.82658 2 8.99992 2.33333 7.99992 3.33333C6.99992 2.33333 6.17325 2 4.99992 2C4.02746 2 3.09483 2.38631 2.40719 3.07394C1.71956 3.76158 1.33325 4.69421 1.33325 5.66667C1.33325 7.2 2.33325 8.36667 3.33325 9.33333L7.99992 14L12.6666 9.33333Z",stroke:"#5F5F6D",strokeWidth:"1.67",strokeLinecap:"round",strokeLinejoin:"round"}),(0,t.jsx)("path",{d:"M8.00008 8.66665L7.33341 7.99998L8.66675 6.66665L6.66675 4.66665L8.00008 3.33331",stroke:"#5F5F6D",strokeWidth:"1.67",strokeLinecap:"round",strokeLinejoin:"round",className:s?"stroke-white dark:stroke-black":""})]})}},725626,e=>{"use strict";e.s(["Overflow",()=>m,"getTagColor",()=>d],725626);var t=e.i(843476),s=e.i(271645),a=e.i(730062),i=e.i(39839),r=e.i(647163),n=e.i(174080),l=e.i(129160),o=e.i(585264),c=e.i(162353);let d=e=>{let t=[{key:"green",class:"text-discovery-tag-green-text border-discovery-tag-green-border bg-discovery-tag-green-ground border"},{key:"cyan",class:"text-discovery-tag-cyan-text border-discovery-tag-cyan-border bg-discovery-tag-cyan-ground border"},{key:"amber",class:"text-discovery-tag-amber-text border-discovery-tag-amber-border bg-discovery-tag-amber-ground  border"},{key:"neutral",class:"text-discovery-tag-neutral-text border-discovery-tag-neutral-border bg-discovery-tag-neutral-ground border"}];return t[e%t.length].class},h=(0,s.forwardRef)((e,n)=>{let{className:l,keyAlias:h,tag:u,registerSize:m,...p}=e,g=(0,s.useRef)(null),f=(0,o.useTranslations)("train-new-model.suggested-tags");return(0,i.useResizeObserver)({ref:g,onResize:e=>{let{width:t}=e;return m(h,t?t+8:0)}}),(0,t.jsx)("div",{ref:g,children:(0,t.jsx)(a.Badge,{variant:"outline",theme:"success",className:(0,r.cn)("whitespace-nowrap",d(h),l),children:(0,c.getTagLabel)(u,f)})})});h.displayName="OverflowItem";let u=(0,s.forwardRef)((e,s)=>{let{className:i,count:n,list:h,...u}=e,m=(0,o.useTranslations)("discovery"),p=(0,o.useTranslations)("train-new-model.suggested-tags");return(0,t.jsxs)(l.Popover,{children:[(0,t.jsx)(l.PopoverTrigger,{children:(0,t.jsx)(a.Badge,{variant:"outline",children:(0,t.jsxs)("span",{children:[n,"+"]})})}),(0,t.jsx)(l.PopoverContent,{align:"end",className:"md:w-[25.125rem]",children:(0,t.jsxs)("div",{children:[(0,t.jsx)("div",{className:"font-semiblod text-xl",children:m("all_tags")}),(0,t.jsx)("div",{className:"mt-4 flex flex-wrap gap-2",children:h.map((e,s)=>(0,t.jsx)(a.Badge,{variant:"outline",className:(0,r.cn)("whitespace-nowrap",d(s)),children:(0,c.getTagLabel)(e,p)},s))})]})})]})});u.displayName="TagsPoppover";let m=(0,s.forwardRef)((e,a)=>{let{className:l,data:o,maxDisplayCount:c,itemClassName:d,...m}=e,p=function(){let e=(0,s.useRef)(null);return t=>{e.current||(e.current=[],Promise.resolve().then(()=>{(0,n.unstable_batchedUpdates)(()=>{var t;null==(t=e.current)||t.forEach(e=>{e()}),e.current=null})})),e.current.push(t)}}(),g=(0,s.useRef)(null),f=(0,s.useRef)(void 0),[x,v]=(0,s.useState)(0),[b,y]=(0,s.useState)(new Map),[k,w]=(0,s.useState)(),[C,j]=(0,s.useState)(!1),[N,T]=(0,s.useState)(!1),_=(0,s.useMemo)(()=>o.filter(Boolean),[o]),S=(0,s.useCallback)(e=>{let{width:t}=e;f.current&&clearTimeout(f.current),f.current=setTimeout(()=>{p(()=>{v(t||0)})},16)},[p]);(0,i.useResizeObserver)({ref:g,onResize:S});let A=(0,s.useCallback)((e,t)=>{p(()=>{y(s=>{let a=new Map(s);return null===t?a.delete(e):a.set(e,t),a})})},[p]),M=(0,s.useCallback)(()=>{if(!x||0===b.size)return void p(()=>{w(0),j(!1)});let e=b.get(0);if(e&&e>x)return void p(()=>{w(-1),j(!0)});let t=0,s=_.length,a=s-1;if(!s)return void p(()=>{w(0),j(!1)});for(let e=0;e<s;e+=1){if("number"==typeof c&&e>=c-1)return void p(()=>{w(c-1),j(!0)});let s=b.get(e);if(void 0===s)return void p(()=>{w(e-1),j(!1)});if(t+=s,0===a&&t<=x)return void p(()=>{w(a),j(!1)});if(t+30>x)return void p(()=>{w(e-1),j(!0)})}p(()=>{w(a),j(!1)})},[x,b,_,30,p,c]);(0,s.useLayoutEffect)(()=>{M()},[M]);let E=(0,s.useMemo)(()=>C&&void 0!==k?_.slice(0,Math.max(k,0)+1):_,[_,k,C]);return(0,s.useEffect)(()=>()=>{f.current&&clearTimeout(f.current)},[]),(0,s.useEffect)(()=>{x&&b.size===_.length&&requestAnimationFrame(()=>{T(!0)})},[x,b.size,_.length]),(0,t.jsx)("div",{className:(0,r.cn)("flex flex-grow items-center overflow-hidden",N?"opacity-100":"opacity-0","transition-opacity duration-150"),children:(0,t.jsx)("div",{ref:g,className:"flex w-full gap-2",style:{minWidth:0},children:-1===k?(0,t.jsx)(u,{count:_.length,list:_}):(0,t.jsxs)(t.Fragment,{children:[E.map((e,s)=>(0,t.jsx)(h,{className:d,keyAlias:s,tag:e,registerSize:A},s)),(0,t.jsx)("div",{className:(0,r.cn)("flex h-full items-end","".concat(E.length<_.length?"":"hidden")),children:(0,t.jsx)(u,{count:E.length+1,list:_})})]})})})});m.displayName="Overflow"},173601,e=>{"use strict";e.s(["VoiceCard",()=>O,"useVoiceCardActions",()=>L],173601);var t=e.i(843476),s=e.i(271645),a=e.i(647163),i=e.i(576167),r=e.i(200997),n=e.i(192049),l=e.i(730062),o=e.i(4272),c=e.i(707621),d=e.i(541071),h=e.i(431343),u=e.i(662031),m=e.i(531278),p=e.i(495242),g=e.i(245046),f=e.i(999445),x=e.i(513959),v=e.i(258679),b=e.i(846696),y=e.i(585264),k=e.i(160889),w=e.i(39839),C=e.i(522016),j=e.i(681846),N=e.i(784273),T=e.i(725626),_=e.i(941855),S=e.i(602596),A=e.i(790830),M=e.i(37727),E=e.i(64585),R=e.i(611995);function P(e){let{children:i,content:r,className:n,side:l="top",align:o="center",defaultOpen:c=!0,onOpenChange:d,borderClassName:h,stepKey:u}=e,{user:m,setUser:p,hasLogin:g}=(0,E.useUser)(),[f,x]=(0,s.useState)(!1),v=(0,s.useRef)(null);return((0,s.useEffect)(()=>{let e=JSON.parse(sessionStorage.getItem("onboarding_record")||"[]");Array.isArray(e)||(e=[]),m?x(![...(null==m?void 0:m.onboarding_record)||[],...e].includes(u)&&c):g||x(!e.includes(u)&&c)},[u,m,c,g]),f)?(0,t.jsxs)("div",{className:"relative",ref:v,children:[i,(0,t.jsxs)("div",{className:(0,a.cn)("absolute z-50 min-w-[16rem] rounded-lg border bg-popover p-4 text-popover-foreground shadow-md outline-none","data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95",h,"top"===l&&"bottom-full mb-3","bottom"===l&&"top-full mt-3","left"===l&&"right-full mr-3","right"===l&&"left-full ml-3","start"===o&&("left"===l||"right"===l?"top-0":"left-0"),"center"===o&&("left"===l||"right"===l?"top-1/2 -translate-y-1/2":"left-1/2 -translate-x-1/2"),"end"===o&&("left"===l||"right"===l?"bottom-0":"right-0"),n),children:[(0,t.jsxs)("button",{onClick:()=>(e=>{if(x(e),!e&&u){let e=JSON.parse(sessionStorage.getItem("onboarding_record")||"[]");Array.isArray(e)||(e=[]);let t=new Set([...e,u]);if(sessionStorage.setItem("onboarding_record",JSON.stringify(Array.from(t))),m){(0,R.pushOnboardingRecord)({user_id:m._id,record:u});let e=new Set([...m.onboarding_record||[],u]);p({...m,onboarding_record:Array.from(e)})}}null==d||d(e)})(!1),className:"absolute right-2 top-2 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100",children:[(0,t.jsx)(M.X,{className:"h-4 w-4"}),(0,t.jsx)("span",{className:"sr-only",children:"Close"})]}),r,(0,t.jsx)("div",{className:(0,a.cn)("absolute h-3 w-3 rotate-45",h,"top"===l&&["bottom-[-6.5px]","border-b border-r","bg-popover"],"bottom"===l&&["top-[-6.5px]","border-l border-t","bg-popover"],"left"===l&&["right-[-6.5px]","border-r border-t","bg-popover"],"right"===l&&["left-[-6.5px]","border-b border-l","bg-popover"],"start"===o&&("left"===l||"right"===l?"top-[15px]":"left-[15px]"),"center"===o&&("left"===l||"right"===l?"top-1/2 -translate-y-1/2":"left-1/2 -translate-x-1/2"),"end"===o&&("left"===l||"right"===l?"bottom-[15px]":"right-[15px]"))})]})]}):i}var U=e.i(558249);let D=function(e){let{avatar:s,user:i,userId:r,time:o,tags:c,samples:d,lng:h=[]}=e,u=c.length>0||h.length>0;return(0,t.jsxs)(n.Timeline,{className:"mt-2",children:[(0,t.jsx)(n.TimeLineUser,{className:"text-xs md:text-sm ".concat(!(null==d?void 0:d.length)&&"max-md:after:content-none"),avatar:s,name:i,userId:r}),(0,t.jsx)(n.TimeLineDate,{className:"max-md:after:content-none",time:o,hasTags:u}),!!(null==d?void 0:d.length)&&(0,t.jsx)(n.TimeLineSamples,{className:"max-md:after:content-none",list:d}),u&&(0,t.jsx)("div",{className:"hidden min-w-0 md:block md:max-w-[24.6875rem] md:flex-1",children:(0,t.jsxs)("div",{className:"flex w-full items-center",children:[(0,t.jsx)("div",{className:"shrink-0",children:(0,t.jsx)("div",{className:"flex gap-2",children:h.map((e,s)=>(0,t.jsx)(l.Badge,{variant:"outline",className:(0,a.cn)("whitespace-nowrap",(0,T.getTagColor)(s)),children:e},s))})}),(0,t.jsx)("div",{className:"w-2 shrink-0"}),(0,t.jsx)("div",{className:"min-w-0 flex-1",children:(0,t.jsx)(T.Overflow,{data:c,maxDisplayCount:3})})]})})]})};function L(e){let[t,a]=s.useState(!1),[i,r]=s.useState(!1),[n,l]=s.useState(!1),[o,c]=s.useState({like:0,mark:0,shared:0}),d=(0,y.useTranslations)("discovery");return s.useEffect(()=>{e&&(a(e.liked),l(e.marked),c({like:e.like_count,mark:e.mark_count,shared:e.shared_count}))},[e]),{like:t,unliked:i,mark:n,count_cache:o,handleLike:function(){e&&(t?v.unLikeModel:v.likeModel)({id:e._id}).then(s=>{t?c({...o,like:o.like-1}):(i&&(0,v.unDislikeModel)({id:e._id}).then(e=>{r(!1)}),c({...o,like:o.like+1})),a(!t)})},handleUnliked:function(){e&&(i?v.unDislikeModel:v.dislikeModel)({id:e._id}).then(s=>{!i&&t&&(0,v.unLikeModel)({id:e._id}).then(e=>{a(!1),c({...o,like:o.like-1})}),r(!i)})},handleMark:function(){e&&(n?v.unMarkModel:v.markModel)({id:e._id}).then(e=>{n?c({...o,mark:o.mark-1}):c({...o,mark:o.mark+1}),l(!n)})},share:function(){if(!e)return;let t="https://fish.audio/m/".concat(e._id);navigator.clipboard.writeText(t),(0,b.toast)(d("copied_title")),(0,v.shareModel)({id:e._id}).then(e=>{c({...o,shared:o.shared+1})})}}}let B=function(e){let{data:s,className:i,...r}=e,{like:n,unliked:l,mark:o,count_cache:c,handleLike:d,handleUnliked:m,handleMark:p,share:v}=L(s),{isCN:b}=(0,_.useEnvironment)();return(0,t.jsxs)("div",{className:(0,a.cn)("flex gap-3 md:gap-6",i),...r,children:[(0,t.jsxs)("div",{className:"flex items-center gap-2 whitespace-nowrap text-xs md:text-sm",children:[(0,t.jsx)(h.Play,{className:"h-4 w-4 shrink-0 text-gray-1 md:h-5 md:w-5"}),(0,t.jsxs)("span",{children:[(0,a.formatThousandthNumber)(s.task_count)," Used"]})]}),!b&&(0,t.jsxs)("div",{className:"flex cursor-pointer items-center gap-2 whitespace-nowrap text-xs md:text-sm",onClick:v,children:[(0,t.jsx)(u.Share2,{className:"h-4 w-4 shrink-0 text-gray-1 md:h-5 md:w-5"}),(0,t.jsxs)("span",{children:[c.shared," Shares"]})]}),(0,t.jsxs)("div",{className:"flex cursor-pointer items-center gap-2",onClick:d,children:[(0,t.jsx)(g.Heart,{className:(0,a.cn)("h-4 w-4 shrink-0 md:h-5 md:w-5",n?"text-red":"text-gray-1"),fillIcon:n}),(0,t.jsx)("span",{className:"text-xs md:text-sm",children:c.like})]}),(0,t.jsx)("div",{className:"flex cursor-pointer items-center gap-2",onClick:m,children:(0,t.jsx)(x.HeartCrack,{className:(0,a.cn)("h-4 w-4 shrink-0 md:h-5 md:w-5",l?"":"text-gray-1"),fillIcon:l})}),(0,t.jsxs)("div",{className:"flex cursor-pointer items-center gap-2",onClick:p,children:[(0,t.jsx)(f.Bookmark,{className:(0,a.cn)("h-4 w-4 shrink-0 md:h-5 md:w-5",o?"":"text-gray-1"),fillIcon:o}),(0,t.jsx)("span",{className:"text-xs md:text-sm",children:c.mark})]})]})},F=function(e){let{data:i,className:r,inner:n,handleUseVoice:l,isFirst:h,preventNavigation:u,...m}=e,p=(0,y.useTranslations)("discovery"),g=(0,k.useRouter)(),[f,x]=s.useState(!1),v=(0,w.useMediaQuery)("(max-width: 768px)"),{user:b}=(0,E.useUser)(),C=(0,t.jsx)("div",{className:"flex flex-col gap-2",children:(0,t.jsx)("div",{className:"flex items-center gap-2",children:(0,t.jsxs)("h4",{className:"font-medium",children:["âœ¨ ",p("try_voice")]})})});return(0,t.jsxs)("div",{className:(0,a.cn)("mt-4 flex flex-col-reverse justify-between md:flex-row md:items-end","md:mt-".concat(n?2:4),r),...m,children:[(0,t.jsxs)("div",{className:"mt-5 flex gap-3 md:mt-0",children:[h?(0,t.jsx)(P,{content:C,defaultOpen:!0,side:"bottom",align:v?"start":"center",className:"min-w-[13rem]",borderClassName:"border-purple-500",stepKey:"discover-use-voice",children:(0,t.jsx)(o.Button,{className:"rounded-xl",size:n?"sm":"default",onClick:()=>{(0,U.track)("discover-use-voice-click",{model_id:i._id},b),null==l||l(i),u||g.push((0,a.getInstantSpeechUrl)(i._id))},children:p("use_voice")})}):(0,t.jsx)(o.Button,{className:"rounded-xl",size:n?"sm":"default",onClick:()=>{null==l||l(i),u||g.push((0,a.getInstantSpeechUrl)(i._id))},children:p("use_voice")}),(0,t.jsxs)(j.DropdownMenu,{modal:!1,children:[(0,t.jsx)(j.DropdownMenuTrigger,{children:(0,t.jsx)(d.MoreHorizontal,{className:"invisible w-fit cursor-pointer group-hover:visible"})}),(0,t.jsx)(j.DropdownMenuPortal,{children:(0,t.jsx)(j.DropdownMenuContent,{align:"start",children:(0,t.jsxs)(j.DropdownMenuItem,{className:"cursor-pointer",onClick:()=>x(!0),children:[(0,t.jsx)("div",{className:"flex h-8 w-8 items-center justify-center rounded-md bg-gray-4 dark:bg-white/10",children:(0,t.jsx)(c.CircleAlert,{className:"w-4 text-gray-1"})}),(0,t.jsx)("span",{className:"ml-4",children:p("report.title")})]})})})]})]}),(0,t.jsx)(B,{data:i}),(0,t.jsx)(N.ReportModel,{link:"https://fish.audio/m/".concat(i._id),open:f,onOpenChange:x})]})},z=function(e){var s,i,r;let{data:n,className:o,handleUseVoice:c,isFirst:d,preventNavigation:h,isDashboard:u,...m}=e;return(0,t.jsxs)("div",{className:(0,a.cn)("flex flex-col items-start justify-between md:hidden",o),...m,children:[!!(null==n||null==(s=n.languages)?void 0:s.length)&&(0,t.jsx)("div",{className:"mt-4 flex gap-2",children:null==n||null==(r=n.languages)||null==(i=r.map)?void 0:i.call(r,(e,s)=>(0,t.jsx)(l.Badge,{type:"outline",className:(0,a.cn)("whitespace-nowrap",(0,T.getTagColor)(s)),children:e},s))}),n.tags.length>0&&(0,t.jsx)("div",{className:"mt-4 w-full min-w-0",children:(0,t.jsx)(T.Overflow,{data:n.tags,maxDisplayCount:5})}),(0,t.jsx)(F,{data:n,handleUseVoice:c,isFirst:d,preventNavigation:h})]})},I=s.forwardRef((e,i)=>{let{className:r,sample:n,index:l,isFirst:o,...c}=e,{isCN:d}=(0,_.useEnvironment)(),u=(0,A.useAudioRef)(),[g,f]=s.useState(!0),{currentPlaying:x,isPlay:v,handlePlayAudio:b}=(0,S.useAudioUniqueControl)(),k=(0,a.formatAudioUrl)(n.audio,d),w=(0,y.useTranslations)("discovery"),C=(0,t.jsxs)("div",{className:(0,a.cn)("flex cursor-pointer items-center gap-2",r),onClick:()=>{if(u.current)try{u.current.paused?b(u.current,!1):b(u.current,!0)}catch(e){console.error(e)}},...c,children:[(0,t.jsx)("audio",{className:"hidden",src:k,controls:!1,onEnded:()=>b(u.current,!0),onError:()=>f(!1),onCanPlayThrough:()=>f(!1),ref:u}),g?(0,t.jsx)(m.Loader2,{className:"h-4 w-4 animate-spin"}):x===u.current&&v?(0,t.jsx)(p.Pause,{className:"h-4 w-4"}):(0,t.jsx)(h.Play,{className:"h-4 w-4"}),(0,t.jsx)("span",{className:"max-w-[min(50vw,320px)] overflow-hidden truncate text-ellipsis whitespace-nowrap text-sm",title:n.text,children:n.text})]}),j=(0,t.jsx)("div",{className:"flex flex-col gap-2",children:(0,t.jsx)("div",{className:"flex items-center gap-2",children:(0,t.jsxs)("h4",{className:"font-medium",children:["ðŸ”Š ",w("preview_sample")]})})});return o&&0===l?(0,t.jsx)(P,{content:j,defaultOpen:!0,side:"top",align:"start",className:"min-w-[18rem]",borderClassName:"border-purple-500",stepKey:"discover-play-sample",children:C}):C});I.displayName="AudioSample";let O=s.forwardRef((e,s)=>{let{className:n,data:l,inner:o,handleUseVoice:c,isFirst:d,preventNavigation:h,isDashboard:u,...m}=e,p=o?"md:h-[6.55rem] md:w-[6.55rem]":"md:h-[7.25rem] md:w-[7.25rem]",g=(0,w.useMediaQuery)("(min-width: 768px)");return(0,t.jsx)(i.Card,{className:(0,a.cn)("group mb-3 rounded-xl",n),...m,children:(0,t.jsxs)(i.CardContent,{className:"flex flex-col p-4 md:p-4",children:[(0,t.jsxs)("div",{className:"flex flex-1",children:[(0,t.jsx)(r.Avatar,{className:(0,a.cn)("mr-3 h-16 w-16 rounded-lg md:mr-4","".concat(p)),children:(0,t.jsx)(r.AvatarImage,{src:(0,a.fetchImage)(l.cover_image,g?128:64),alt:l.title})}),(0,t.jsxs)("div",{className:"flex flex-1 flex-col",children:[(0,t.jsx)(i.CardTitle,{className:(0,a.cn)("max-md:text-base","".concat(g&&o?"mt-0":""),"".concat(o?"text-lg":"")),children:(0,t.jsx)(C.default,{href:u?"/app/m/".concat(l._id):"/m/".concat(l._id),children:l.title})}),(0,t.jsx)(D,{user:l.author.nickname,userId:l.author._id,avatar:l.author.avatar,time:l.created_at,tags:l.tags,samples:l.samples,lng:l.languages}),l.samples&&l.samples.length>0&&(0,t.jsx)("div",{className:"mt-2 flex flex-col space-y-2",children:l.samples.slice(0,3).map((e,s)=>(0,t.jsx)(I,{sample:e,index:s,isFirst:d},s))}),(0,t.jsx)("div",{className:"w-full flex-1"}),(0,t.jsx)(F,{className:"hidden md:flex",data:l,inner:o,handleUseVoice:c,isFirst:d,preventNavigation:h})]})]}),(0,t.jsx)(z,{data:l,handleUseVoice:c,isFirst:d,preventNavigation:h,isDashboard:u})]})})});O.displayName="VoiceCard"},703383,e=>{"use strict";e.s(["useAsync",()=>a],703383);var t=e.i(271645),s=e.i(540233);function a(e,a){void 0===a&&(a=[]);var i=(0,s.default)(e,a,{loading:!0}),r=i[0],n=i[1];return(0,t.useEffect)(function(){n()},[n]),r}},874183,104532,e=>{"use strict";e.s(["AudioPlayer",()=>i],874183);var t=e.i(299749);e.s(["audioContextManager",()=>a],104532);class s{static getInstance(){return s.instance||(s.instance=new s),s.instance}getContext(){return this.context||(this.context=new AudioContext,this.masterGainNode=this.context.createGain(),this.masterGainNode.gain.value=this.volume,this.masterGainNode.connect(this.context.destination)),this.context}getMasterGainNode(){if(!this.masterGainNode){let e=this.getContext();this.masterGainNode=e.createGain(),this.masterGainNode.gain.value=this.volume,this.masterGainNode.connect(e.destination)}return this.masterGainNode}async resumeContext(){let e=this.getContext();"suspended"===e.state&&await e.resume()}async initialize(){if(this.isInitialized)return;let e=this.getContext(),t=e.createBuffer(1,1,22050),s=e.createBufferSource();s.buffer=t,s.connect(this.getMasterGainNode());try{s.start(0),this.isInitialized=!0}catch(e){console.error("Failed to initialize audio:",e)}}setVolume(e){this.volume=e,this.masterGainNode&&(this.masterGainNode.gain.value=e)}constructor(){(0,t._)(this,"context",null),(0,t._)(this,"masterGainNode",null),(0,t._)(this,"volume",1),(0,t._)(this,"isInitialized",!1)}}(0,t._)(s,"instance",void 0);let a=s.getInstance();class i{on(e,t){this.listeners[e]=this.listeners[e].filter(e=>e!==t),this.listeners[e].push(t)}off(e,t){this.listeners[e]=this.listeners[e].filter(e=>e!==t)}emit(e){for(var t=arguments.length,s=Array(t>1?t-1:0),a=1;a<t;a++)s[a-1]=arguments[a];this.listeners[e].forEach(e=>e(...s))}computeTime(){if(0===this.allData.length)return;let e=this.allData.reduce((e,t)=>e+((null==t?void 0:t.length)||0),0);0!==e&&(this.durationCache=e/this.sampleRate,this.emit("durationUpdate",this.durationCache))}tryEmitCanplay(){this.canplayEmitted||(this.emit("canplay"),this.canplayEmitted=!0)}loadDoneHandle(){this.loadDone=!0,this.tryEmitCanplay(),this.emit("loadDone"),this.options.lowPower||this.computeTime()}async downloadByReader(){"wav"===this.format?await this.processWavStream():await this.processMp3Stream()}async processWavStream(){let e=new Uint8Array(0),t=performance.now(),s=-1,a=!1,i={channels:this.channels,sampleRate:this.sampleRate,bitsPerSample:16},r=!1;for(;;){let{done:n,value:l}=await this.reader.read();if(n){this.loadDoneHandle();break}e=this.concatTypedArrays(e,l),l.length;let o=performance.now();if(s<0&&(s=o-t),r){let t=2*Math.floor(e.length/2);if(t>0){let s=e.slice(0,t);e=e.slice(t);let a=new Int16Array(s.buffer,s.byteOffset,s.length/2),i=this.int16ToFloat32(a);this.allData.push(i),this.processedChunks++,this.playQueue&&this.playQueue.push(i),this.processedChunks>=this.minChunksBeforePlay&&this.tryEmitCanplay()}continue}if(!a&&e.length>=44){let t=function(e){let t=String.fromCharCode(...Array.from(e.slice(0,4))),s=String.fromCharCode(...Array.from(e.slice(8,12)));if("RIFF"===t&&"WAVE"===s){let t=new DataView(e.buffer,e.byteOffset,44);return{isValid:!0,format:{channels:t.getUint16(22,!0),sampleRate:t.getUint32(24,!0),bitsPerSample:t.getUint16(34,!0)}}}return{isValid:!1}}(e);t.isValid?(i=t.format,this.sampleRate=i.sampleRate,e=e.slice(44),a=!0):r=!0}if(a){let t=2*Math.floor(e.length/2);if(t>0){let s=e.slice(0,t);e=e.slice(t);let a=new Int16Array(s.buffer,s.byteOffset,s.length/2),i=this.int16ToFloat32(a);this.allData.push(i),this.processedChunks++,this.playQueue&&this.playQueue.push(i),this.processedChunks>=this.minChunksBeforePlay&&this.tryEmitCanplay()}}}}async processMp3Stream(){let{MPEGDecoderWebWorker:t}=await e.A(529605),s=new Uint8Array(0),a=performance.now(),i=-1,r=new t,n=null,l=[];for(;;){let{done:e,value:t}=await this.reader.read();if(e){await Promise.all(l),null==n||n.then(()=>{r.free(),this.loadDoneHandle()});break}s=this.concatTypedArrays(s,t),t.length;let o=performance.now();i<0&&(i=o-a);let c=2*Math.floor(s.length/2),d=s.slice(0,c);s=s.slice(c),n=r.ready.then(()=>{let e=r.decode(d).then(e=>{let{channelData:t}=e,[s]=t;this.allData.push(s),this.processedChunks++,this.playQueue&&this.playQueue.push(s),this.processedChunks>=this.minChunksBeforePlay&&this.tryEmitCanplay()}).catch(e=>{console.error(e)});return l.push(e),e})}}concatTypedArrays(e,t){let s=new Uint8Array(e.length+t.length);return s.set(e,0),s.set(t,e.length),s}int16ToFloat32(e){let t=new Float32Array(e.length);for(let s=0;s<e.length;s++)t[s]=e[s]/32768;return t}timeUpdateFn(){"playing"===this.playStatus&&this.emit("timeupdate",this.currentTime)}async play(){if(await a.initialize(),this.playQueue&&0===this.playQueue.length){var e;return this.loadDone?void this.stop():(null==(e=this.audioContext)||e.suspend(),this.playStatus="pending",void(this.waitTimer=setTimeout(this.play,100)))}this.waitTimer=null,this.playQueue||(this.playQueue=this.allData.slice());let t=null===this.audioContext;null===this.audioContext&&(this.audioContext=a.getContext(),this.timeUpdateTimer=setInterval(this.timeUpdateFn.bind(this),200)),"suspended"===this.audioContext.state&&a.resumeContext(),this.offsetTime=this.audioContext.currentTime;let s=[];for(;this.playQueue.length>0;)s.push(this.playQueue.shift());let i=s.reduce((e,t)=>e+((null==t?void 0:t.length)||0),0);if(0===i){this.waitTimer=setTimeout(this.play,100);return}let r=new Float32Array(i),n=0;s.forEach(e=>{r.set(e,n),n+=e.length});let l=this.audioContext.createBuffer(1,r.length,this.sampleRate);l.copyToChannel(r,0);let o=this.audioContext.createBufferSource();this.currentSource=o,o.buffer=l,o.connect(a.getMasterGainNode()),o.onended=()=>{this.currentSource===o&&"playing"===this.playStatus&&(this.startTime=this.currentTime,setTimeout(()=>{this.play()}))},t?o.start(0,this.startTime):o.start(),this.playStatus="playing"}clearAudioContext(){this.currentSource&&(this.currentSource.stop(),this.currentSource.disconnect(),this.currentSource=null),this.audioContext&&(this.audioContext.suspend(),this.audioContext=null,this.offsetTime=0),this.waitTimer&&clearTimeout(this.waitTimer),this.timeUpdateTimer&&clearInterval(this.timeUpdateTimer),this.playQueue=null}pause(){this.audioContext&&"pending"!==this.playStatus&&(this.startTime=this.currentTime),this.clearAudioContext(),this.playStatus="pause",this.emit("stop")}stop(){this.clearAudioContext(),this.startTime=0,this.playStatus="stop",this.emit("stop"),this.emit("timeupdate",0)}close(){var e;null==(e=this.audioContext)||e.close()}get duration(){return this.durationCache}get volume(){return this.volumeProxy}set volume(e){this.volumeProxy=e,a.setVolume(e)}set currentTime(e){if("playing"===this.playStatus||"pending"===this.playStatus){this.stop(),this.startTime=e,this.play();return}this.startTime=e}get currentTime(){if("playing"===this.playStatus){var e;return((null==(e=this.audioContext)?void 0:e.currentTime)||0)+this.startTime-this.offsetTime}return this.startTime}constructor(e,s={}){(0,t._)(this,"reader",void 0),(0,t._)(this,"options",void 0),(0,t._)(this,"format",void 0),(0,t._)(this,"channels",void 0),(0,t._)(this,"loadDone",void 0),(0,t._)(this,"playQueue",void 0),(0,t._)(this,"allData",void 0),(0,t._)(this,"sampleRate",void 0),(0,t._)(this,"durationCache",void 0),(0,t._)(this,"playStatus",void 0),(0,t._)(this,"canplayEmitted",void 0),(0,t._)(this,"processedChunks",void 0),(0,t._)(this,"minChunksBeforePlay",void 0),(0,t._)(this,"listeners",void 0),(0,t._)(this,"audioContext",void 0),(0,t._)(this,"volumeProxy",void 0),(0,t._)(this,"startTime",void 0),(0,t._)(this,"offsetTime",void 0),(0,t._)(this,"waitTimer",void 0),(0,t._)(this,"timeUpdateTimer",void 0),(0,t._)(this,"currentSource",void 0),this.reader=e,this.options=s,this.format="mp3",this.channels=1,this.loadDone=!1,this.playQueue=null,this.allData=[],this.sampleRate=44100,this.durationCache=-1,this.playStatus="stop",this.canplayEmitted=!1,this.processedChunks=0,this.minChunksBeforePlay=3,this.listeners={loadDone:[],stop:[],durationUpdate:[],timeupdate:[],canplay:[]},this.audioContext=null,this.volumeProxy=1,this.startTime=0,this.offsetTime=0,this.waitTimer=null,this.timeUpdateTimer=null,this.currentSource=null,this.options.sampleRate&&(this.sampleRate=this.options.sampleRate),this.format=this.options.format||"mp3",this.channels=this.options.channels||1,this.downloadByReader(),this.play=this.play.bind(this),this.pause=this.pause.bind(this),this.emit=this.emit.bind(this)}}},465061,e=>{"use strict";e.s(["InstantTaskEventStream",()=>f,"createTTSTask",()=>i,"deleteTask",()=>o,"deleteTaskFeedback",()=>u,"downLoadStats",()=>d,"getCreditTasks",()=>l,"getModelLastUsed",()=>c,"getSelfTask",()=>n,"getTask",()=>r,"getTaskExamples",()=>m,"getTaskShareUrl",()=>g,"postTaskClone",()=>p,"postTaskFeedback",()=>h]);var t=e.i(299749),s=e.i(874183),a=e.i(100574);let i=async e=>{let t=new AbortController,i=setTimeout(()=>t.abort(),36e5),r=await fetch("".concat(a.BASE_URL,"/task"),{method:"POST",headers:{authorization:(0,a.getAuthorization)(),"content-type":"application/json"},body:JSON.stringify({type:"tts",stream:!0,model:e.model,turnstile:e.turnstile,prosody:e.prosody,latency:e.latency,parameters:{text:e.text},recaptcha:e.recaptcha,format:"mp3",backend:e.backend,sampler:e.sampler}),signal:t.signal});if(clearTimeout(i),401==r.status&&(0,a.handle401)(),!r.ok)if(r.status>=400&&r.status<500)(0,a.handle4xx)(await r.json());else throw Error("Unknown error occurred");let n=r.body.getReader();return r.headers.forEach((e,t)=>{console.log(t,e)}),{taskId:r.headers.get("task-id"),audio:new s.AudioPlayer(n)}},r=a.fetcher.path("/task/{task_id}").method("get").create(),n=a.fetcher.path("/task").method("get").create(),l=a.fetcher.path("/task/usage").method("get").create(),o=a.fetcher.path("/task").method("delete").create(),c=a.fetcher.path("/model/latest-used").method("get").create(),d=a.fetcher.path("/task/download-stats").method("post").create(),h=a.fetcher.path("/task/{task_id}/feedback").method("post").create(),u=a.fetcher.path("/task/{task_id}/feedback").method("delete").create(),m=a.fetcher.path("/task/example").method("get").create(),p=a.fetcher.path("/task/{task_id}/clone").method("post").create(),g=a.fetcher.path("/task/{task_id}/share-url").method("get").create();class f{async start(e){try{this.abortController=new AbortController;let t="".concat(a.BASE_URL,"/task/instant"),s=new FormData;s.append("audio",e.audio),e.recaptcha&&s.append("recaptcha",e.recaptcha);let i=await fetch(t,{method:"POST",headers:{Authorization:(0,a.getAuthorization)(),Accept:"text/event-stream"},body:s,signal:this.abortController.signal});if(!i.ok)throw Error("".concat(i.status," ").concat(i.statusText));if(!i.body)throw Error("response body is empty");this.isProcessing=!0,this.processStream(i.body)}catch(e){var t,s;throw null==(t=(s=this.callbacks).onError)||t.call(s,e),e}}async processStream(e){var t,s,a,i;let r=e.getReader(),n=new TextDecoder,l="";try{for(;this.isProcessing;){let{value:e,done:a}=await r.read();if(a)break;l+=n.decode(e,{stream:!0});let i=this.extractEvents(l);for(let e of(l=i.remainder,i.events))try{if(e.startsWith("data: ")){let t=e.slice(6),s=JSON.parse(t);this.handleEvent(s)}}catch(a){console.error(a,e),null==(t=(s=this.callbacks).onError)||t.call(s,a)}}}catch(e){"AbortError"!==e.name&&(console.error(e),null==(a=(i=this.callbacks).onError)||a.call(i,e))}finally{r.releaseLock()}}extractEvents(e){let t=e.split("\n\n");return{events:t.slice(0,-1),remainder:t[t.length-1]}}handleEvent(e){var t,s,a,i,r,n,l,o,c,d,h,u,m,p,g,f,x,v,b,y,k,w;let{message:C,duration:j,text:N,language:T,audio:_,alignment:S,type:A}=e;switch(C){case"asr_started":null==(t=(s=this.callbacks).onAsrStarted)||t.call(s);break;case"asr_finished":null==(a=(i=this.callbacks).onAsrFinished)||a.call(i,j||0,N||"",T);break;case"random_text_generation_started":null==(r=(n=this.callbacks).onRandomTextGenerationStarted)||r.call(n);break;case"random_text_generation_finished":null==(l=(o=this.callbacks).onRandomTextGenerationFinished)||l.call(o,N||"");break;case"tts_generation_started":null==(c=(d=this.callbacks).onTtsGenerationStarted)||c.call(d);break;case"tts_generation_finished":null==(h=(u=this.callbacks).onTtsGenerationFinished)||h.call(u);break;case"alignment_generation_started":null==(m=(p=this.callbacks).onAlignmentGenerationStarted)||m.call(p);break;case"alignment_generation_finished":null==(g=(f=this.callbacks).onAlignmentGenerationFinished)||g.call(f);break;case"tts_audio_and_alignment_generation_finished":null==(x=(v=this.callbacks).onTtsAudioAndAlignmentFinished)||x.call(v,_||"",S);break;case"asr_internal_error":null==(b=(y=this.callbacks).onError)||b.call(y,e);break;default:"error"===A?null==(k=(w=this.callbacks).onError)||k.call(w,e):console.log("unhandled event:",C)}}close(){this.isProcessing=!1,this.abortController&&(this.abortController.abort(),this.abortController=null)}constructor(e={}){(0,t._)(this,"abortController",null),(0,t._)(this,"callbacks",void 0),(0,t._)(this,"isProcessing",!1),this.callbacks=e}}}]);