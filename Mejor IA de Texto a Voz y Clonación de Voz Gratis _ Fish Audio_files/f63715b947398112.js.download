(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,874183,104532,e=>{"use strict";e.s(["AudioPlayer",()=>r],874183);var t=e.i(299749);e.s(["audioContextManager",()=>i],104532);class s{static getInstance(){return s.instance||(s.instance=new s),s.instance}getContext(){return this.context||(this.context=new AudioContext,this.masterGainNode=this.context.createGain(),this.masterGainNode.gain.value=this.volume,this.masterGainNode.connect(this.context.destination)),this.context}getMasterGainNode(){if(!this.masterGainNode){let e=this.getContext();this.masterGainNode=e.createGain(),this.masterGainNode.gain.value=this.volume,this.masterGainNode.connect(e.destination)}return this.masterGainNode}async resumeContext(){let e=this.getContext();"suspended"===e.state&&await e.resume()}async initialize(){if(this.isInitialized)return;let e=this.getContext(),t=e.createBuffer(1,1,22050),s=e.createBufferSource();s.buffer=t,s.connect(this.getMasterGainNode());try{s.start(0),this.isInitialized=!0}catch(e){console.error("Failed to initialize audio:",e)}}setVolume(e){this.volume=e,this.masterGainNode&&(this.masterGainNode.gain.value=e)}constructor(){(0,t._)(this,"context",null),(0,t._)(this,"masterGainNode",null),(0,t._)(this,"volume",1),(0,t._)(this,"isInitialized",!1)}}(0,t._)(s,"instance",void 0);let i=s.getInstance();class r{on(e,t){this.listeners[e]=this.listeners[e].filter(e=>e!==t),this.listeners[e].push(t)}off(e,t){this.listeners[e]=this.listeners[e].filter(e=>e!==t)}emit(e){for(var t=arguments.length,s=Array(t>1?t-1:0),i=1;i<t;i++)s[i-1]=arguments[i];this.listeners[e].forEach(e=>e(...s))}computeTime(){if(0===this.allData.length)return;let e=this.allData.reduce((e,t)=>e+((null==t?void 0:t.length)||0),0);0!==e&&(this.durationCache=e/this.sampleRate,this.emit("durationUpdate",this.durationCache))}tryEmitCanplay(){this.canplayEmitted||(this.emit("canplay"),this.canplayEmitted=!0)}loadDoneHandle(){this.loadDone=!0,this.tryEmitCanplay(),this.emit("loadDone"),this.options.lowPower||this.computeTime()}async downloadByReader(){"wav"===this.format?await this.processWavStream():await this.processMp3Stream()}async processWavStream(){let e=new Uint8Array(0),t=performance.now(),s=-1,i=!1,r={channels:this.channels,sampleRate:this.sampleRate,bitsPerSample:16},a=!1;for(;;){let{done:n,value:l}=await this.reader.read();if(n){this.loadDoneHandle();break}e=this.concatTypedArrays(e,l),l.length;let o=performance.now();if(s<0&&(s=o-t),a){let t=2*Math.floor(e.length/2);if(t>0){let s=e.slice(0,t);e=e.slice(t);let i=new Int16Array(s.buffer,s.byteOffset,s.length/2),r=this.int16ToFloat32(i);this.allData.push(r),this.processedChunks++,this.playQueue&&this.playQueue.push(r),this.processedChunks>=this.minChunksBeforePlay&&this.tryEmitCanplay()}continue}if(!i&&e.length>=44){let t=function(e){let t=String.fromCharCode(...Array.from(e.slice(0,4))),s=String.fromCharCode(...Array.from(e.slice(8,12)));if("RIFF"===t&&"WAVE"===s){let t=new DataView(e.buffer,e.byteOffset,44);return{isValid:!0,format:{channels:t.getUint16(22,!0),sampleRate:t.getUint32(24,!0),bitsPerSample:t.getUint16(34,!0)}}}return{isValid:!1}}(e);t.isValid?(r=t.format,this.sampleRate=r.sampleRate,e=e.slice(44),i=!0):a=!0}if(i){let t=2*Math.floor(e.length/2);if(t>0){let s=e.slice(0,t);e=e.slice(t);let i=new Int16Array(s.buffer,s.byteOffset,s.length/2),r=this.int16ToFloat32(i);this.allData.push(r),this.processedChunks++,this.playQueue&&this.playQueue.push(r),this.processedChunks>=this.minChunksBeforePlay&&this.tryEmitCanplay()}}}}async processMp3Stream(){let{MPEGDecoderWebWorker:t}=await e.A(529605),s=new Uint8Array(0),i=performance.now(),r=-1,a=new t,n=null,l=[];for(;;){let{done:e,value:t}=await this.reader.read();if(e){await Promise.all(l),null==n||n.then(()=>{a.free(),this.loadDoneHandle()});break}s=this.concatTypedArrays(s,t),t.length;let o=performance.now();r<0&&(r=o-i);let d=2*Math.floor(s.length/2),c=s.slice(0,d);s=s.slice(d),n=a.ready.then(()=>{let e=a.decode(c).then(e=>{let{channelData:t}=e,[s]=t;this.allData.push(s),this.processedChunks++,this.playQueue&&this.playQueue.push(s),this.processedChunks>=this.minChunksBeforePlay&&this.tryEmitCanplay()}).catch(e=>{console.error(e)});return l.push(e),e})}}concatTypedArrays(e,t){let s=new Uint8Array(e.length+t.length);return s.set(e,0),s.set(t,e.length),s}int16ToFloat32(e){let t=new Float32Array(e.length);for(let s=0;s<e.length;s++)t[s]=e[s]/32768;return t}timeUpdateFn(){"playing"===this.playStatus&&this.emit("timeupdate",this.currentTime)}async play(){if(await i.initialize(),this.playQueue&&0===this.playQueue.length){var e;return this.loadDone?void this.stop():(null==(e=this.audioContext)||e.suspend(),this.playStatus="pending",void(this.waitTimer=setTimeout(this.play,100)))}this.waitTimer=null,this.playQueue||(this.playQueue=this.allData.slice());let t=null===this.audioContext;null===this.audioContext&&(this.audioContext=i.getContext(),this.timeUpdateTimer=setInterval(this.timeUpdateFn.bind(this),200)),"suspended"===this.audioContext.state&&i.resumeContext(),this.offsetTime=this.audioContext.currentTime;let s=[];for(;this.playQueue.length>0;)s.push(this.playQueue.shift());let r=s.reduce((e,t)=>e+((null==t?void 0:t.length)||0),0);if(0===r){this.waitTimer=setTimeout(this.play,100);return}let a=new Float32Array(r),n=0;s.forEach(e=>{a.set(e,n),n+=e.length});let l=this.audioContext.createBuffer(1,a.length,this.sampleRate);l.copyToChannel(a,0);let o=this.audioContext.createBufferSource();this.currentSource=o,o.buffer=l,o.connect(i.getMasterGainNode()),o.onended=()=>{this.currentSource===o&&"playing"===this.playStatus&&(this.startTime=this.currentTime,setTimeout(()=>{this.play()}))},t?o.start(0,this.startTime):o.start(),this.playStatus="playing"}clearAudioContext(){this.currentSource&&(this.currentSource.stop(),this.currentSource.disconnect(),this.currentSource=null),this.audioContext&&(this.audioContext.suspend(),this.audioContext=null,this.offsetTime=0),this.waitTimer&&clearTimeout(this.waitTimer),this.timeUpdateTimer&&clearInterval(this.timeUpdateTimer),this.playQueue=null}pause(){this.audioContext&&"pending"!==this.playStatus&&(this.startTime=this.currentTime),this.clearAudioContext(),this.playStatus="pause",this.emit("stop")}stop(){this.clearAudioContext(),this.startTime=0,this.playStatus="stop",this.emit("stop"),this.emit("timeupdate",0)}close(){var e;null==(e=this.audioContext)||e.close()}get duration(){return this.durationCache}get volume(){return this.volumeProxy}set volume(e){this.volumeProxy=e,i.setVolume(e)}set currentTime(e){if("playing"===this.playStatus||"pending"===this.playStatus){this.stop(),this.startTime=e,this.play();return}this.startTime=e}get currentTime(){if("playing"===this.playStatus){var e;return((null==(e=this.audioContext)?void 0:e.currentTime)||0)+this.startTime-this.offsetTime}return this.startTime}constructor(e,s={}){(0,t._)(this,"reader",void 0),(0,t._)(this,"options",void 0),(0,t._)(this,"format",void 0),(0,t._)(this,"channels",void 0),(0,t._)(this,"loadDone",void 0),(0,t._)(this,"playQueue",void 0),(0,t._)(this,"allData",void 0),(0,t._)(this,"sampleRate",void 0),(0,t._)(this,"durationCache",void 0),(0,t._)(this,"playStatus",void 0),(0,t._)(this,"canplayEmitted",void 0),(0,t._)(this,"processedChunks",void 0),(0,t._)(this,"minChunksBeforePlay",void 0),(0,t._)(this,"listeners",void 0),(0,t._)(this,"audioContext",void 0),(0,t._)(this,"volumeProxy",void 0),(0,t._)(this,"startTime",void 0),(0,t._)(this,"offsetTime",void 0),(0,t._)(this,"waitTimer",void 0),(0,t._)(this,"timeUpdateTimer",void 0),(0,t._)(this,"currentSource",void 0),this.reader=e,this.options=s,this.format="mp3",this.channels=1,this.loadDone=!1,this.playQueue=null,this.allData=[],this.sampleRate=44100,this.durationCache=-1,this.playStatus="stop",this.canplayEmitted=!1,this.processedChunks=0,this.minChunksBeforePlay=3,this.listeners={loadDone:[],stop:[],durationUpdate:[],timeupdate:[],canplay:[]},this.audioContext=null,this.volumeProxy=1,this.startTime=0,this.offsetTime=0,this.waitTimer=null,this.timeUpdateTimer=null,this.currentSource=null,this.options.sampleRate&&(this.sampleRate=this.options.sampleRate),this.format=this.options.format||"mp3",this.channels=this.options.channels||1,this.downloadByReader(),this.play=this.play.bind(this),this.pause=this.pause.bind(this),this.emit=this.emit.bind(this)}}},703383,e=>{"use strict";e.s(["useAsync",()=>i],703383);var t=e.i(271645),s=e.i(540233);function i(e,i){void 0===i&&(i=[]);var r=(0,s.default)(e,i,{loading:!0}),a=r[0],n=r[1];return(0,t.useEffect)(function(){n()},[n]),a}},672345,e=>{"use strict";e.s(["addModelToCollection",()=>o,"createVoiceCollection",()=>s,"deleteCollectionModel",()=>l,"deleteVoiceCollection",()=>a,"followCollection",()=>d,"getCollectionModels",()=>n,"listVoiceCollection",()=>i,"unfollowCollection",()=>c,"updateVoiceCollection",()=>r]);var t=e.i(100574);let s=t.fetcher.path("/collection").method("post").create(),i=t.fetcher.path("/collection").method("get").create();t.fetcher.path("/collection/{id}").method("get").create(),t.fetcher.path("/collection/{id}").method("get").create();let r=t.fetcher.path("/collection/{id}").method("put").create(),a=t.fetcher.path("/collection/{id}").method("delete").create(),n=t.fetcher.path("/collection/{id}/models").method("get").create(),l=t.fetcher.path("/collection/{id}/models/{model_id}").method("delete").create(),o=t.fetcher.path("/collection/{id}/models/{model_id}").method("post").create(),d=t.fetcher.path("/collection/{id}/follow").method("post").create(),c=t.fetcher.path("/collection/{id}/follow").method("delete").create()},495242,361839,e=>{"use strict";e.s(["Pause",()=>t],495242),e.s(["default",()=>t],361839);let t=(0,e.i(475254).default)("pause",[["rect",{x:"14",y:"3",width:"5",height:"18",rx:"1",key:"kaeet6"}],["rect",{x:"5",y:"3",width:"5",height:"18",rx:"1",key:"1wsw3u"}]])},431343,451477,e=>{"use strict";e.s(["Play",()=>t],431343),e.s(["default",()=>t],451477);let t=(0,e.i(475254).default)("play",[["path",{d:"M5 5a2 2 0 0 1 3.008-1.728l11.997 6.998a2 2 0 0 1 .003 3.458l-12 7A2 2 0 0 1 5 19z",key:"10ikf1"}]])},541071,373488,e=>{"use strict";e.s(["MoreHorizontal",()=>t],541071),e.s(["default",()=>t],373488);let t=(0,e.i(475254).default)("ellipsis",[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"19",cy:"12",r:"1",key:"1wjl8i"}],["circle",{cx:"5",cy:"12",r:"1",key:"1pcz8c"}]])},730062,e=>{"use strict";e.s(["Badge",()=>a]);var t=e.i(843476),s=e.i(225913),i=e.i(647163);let r=(0,s.cva)("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground"},type:{outline:"rounded-md",square:"rounded-md",circle:"rounded-full","outline-circle":"rounded-full"},theme:{default:"",info:"bg-badge-info-ground text-badge-info-text hover:bg-info-ground",blue:"bg-badge-blue-ground text-badge-blue-text hover:bg-blue-ground",destructive:"bg-badge-destructive-ground text-badge-destructive-text hover:bg-destructive-ground",success:"bg-badge-success-ground text-badge-success-text hover:bg-success-ground"}},compoundVariants:[{theme:"blue",type:["outline","outline-circle"],class:"border-badge-blue-border border bg-badge-blue-outlineground text-badge-blue-outlinetext hover:bg-blue-outlineground"},{theme:"success",type:["outline","outline-circle"],class:"border-badge-success-border border bg-badge-success-outlineground text-badge-success-outlinetext hover:bg-success-outlineground"},{theme:"destructive",type:["outline","outline-circle"],class:"border-badge-destructive-border border bg-badge-destructive-outlineground text-badge-destructive-outlinetext hover:bg-destructive-outlineground"},{theme:"info",type:["outline","outline-circle"],class:"border-badge-info-border border bg-badge-info-outlineground text-badge-info-outlinetext hover:bg-info-outlineground"}],defaultVariants:{variant:"default",type:"circle"}});function a(e){let{className:s,variant:a,type:n,theme:l,...o}=e;return(0,t.jsx)("div",{className:(0,i.cn)(r({variant:a,type:n,theme:l}),s),...o})}},245046,e=>{"use strict";e.s(["Heart",()=>s]);var t=e.i(843476);function s(e){let{fillIcon:s,...i}=e;return(0,t.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 20 20",...i,children:(0,t.jsx)("path",{d:"M6.24984 3.33325C3.71859 3.33325 1.6665 5.38534 1.6665 7.91659C1.6665 12.4999 7.08317 16.6666 9.99984 17.6358C12.9165 16.6666 18.3332 12.4999 18.3332 7.91659C18.3332 5.38534 16.2811 3.33325 13.7498 3.33325C12.1998 3.33325 10.829 4.10284 9.99984 5.28075C9.5772 4.67876 9.01574 4.18746 8.36298 3.84846C7.71021 3.50945 6.98538 3.33273 6.24984 3.33325Z",stroke:"currentColor",fill:s?"currentColor":"none",strokeWidth:"1.66667",strokeLinecap:"round",strokeLinejoin:"round"})})}},725626,e=>{"use strict";e.s(["Overflow",()=>m,"getTagColor",()=>c],725626);var t=e.i(843476),s=e.i(271645),i=e.i(730062),r=e.i(39839),a=e.i(647163),n=e.i(174080),l=e.i(129160),o=e.i(585264),d=e.i(162353);let c=e=>{let t=[{key:"green",class:"text-discovery-tag-green-text border-discovery-tag-green-border bg-discovery-tag-green-ground border"},{key:"cyan",class:"text-discovery-tag-cyan-text border-discovery-tag-cyan-border bg-discovery-tag-cyan-ground border"},{key:"amber",class:"text-discovery-tag-amber-text border-discovery-tag-amber-border bg-discovery-tag-amber-ground  border"},{key:"neutral",class:"text-discovery-tag-neutral-text border-discovery-tag-neutral-border bg-discovery-tag-neutral-ground border"}];return t[e%t.length].class},u=(0,s.forwardRef)((e,n)=>{let{className:l,keyAlias:u,tag:h,registerSize:m,...p}=e,f=(0,s.useRef)(null),g=(0,o.useTranslations)("train-new-model.suggested-tags");return(0,r.useResizeObserver)({ref:f,onResize:e=>{let{width:t}=e;return m(u,t?t+8:0)}}),(0,t.jsx)("div",{ref:f,children:(0,t.jsx)(i.Badge,{variant:"outline",theme:"success",className:(0,a.cn)("whitespace-nowrap",c(u),l),children:(0,d.getTagLabel)(h,g)})})});u.displayName="OverflowItem";let h=(0,s.forwardRef)((e,s)=>{let{className:r,count:n,list:u,...h}=e,m=(0,o.useTranslations)("discovery"),p=(0,o.useTranslations)("train-new-model.suggested-tags");return(0,t.jsxs)(l.Popover,{children:[(0,t.jsx)(l.PopoverTrigger,{children:(0,t.jsx)(i.Badge,{variant:"outline",children:(0,t.jsxs)("span",{children:[n,"+"]})})}),(0,t.jsx)(l.PopoverContent,{align:"end",className:"md:w-[25.125rem]",children:(0,t.jsxs)("div",{children:[(0,t.jsx)("div",{className:"font-semiblod text-xl",children:m("all_tags")}),(0,t.jsx)("div",{className:"mt-4 flex flex-wrap gap-2",children:u.map((e,s)=>(0,t.jsx)(i.Badge,{variant:"outline",className:(0,a.cn)("whitespace-nowrap",c(s)),children:(0,d.getTagLabel)(e,p)},s))})]})})]})});h.displayName="TagsPoppover";let m=(0,s.forwardRef)((e,i)=>{let{className:l,data:o,maxDisplayCount:d,itemClassName:c,...m}=e,p=function(){let e=(0,s.useRef)(null);return t=>{e.current||(e.current=[],Promise.resolve().then(()=>{(0,n.unstable_batchedUpdates)(()=>{var t;null==(t=e.current)||t.forEach(e=>{e()}),e.current=null})})),e.current.push(t)}}(),f=(0,s.useRef)(null),g=(0,s.useRef)(void 0),[x,v]=(0,s.useState)(0),[y,b]=(0,s.useState)(new Map),[w,C]=(0,s.useState)(),[j,k]=(0,s.useState)(!1),[N,T]=(0,s.useState)(!1),_=(0,s.useMemo)(()=>o.filter(Boolean),[o]),S=(0,s.useCallback)(e=>{let{width:t}=e;g.current&&clearTimeout(g.current),g.current=setTimeout(()=>{p(()=>{v(t||0)})},16)},[p]);(0,r.useResizeObserver)({ref:f,onResize:S});let M=(0,s.useCallback)((e,t)=>{p(()=>{b(s=>{let i=new Map(s);return null===t?i.delete(e):i.set(e,t),i})})},[p]),A=(0,s.useCallback)(()=>{if(!x||0===y.size)return void p(()=>{C(0),k(!1)});let e=y.get(0);if(e&&e>x)return void p(()=>{C(-1),k(!0)});let t=0,s=_.length,i=s-1;if(!s)return void p(()=>{C(0),k(!1)});for(let e=0;e<s;e+=1){if("number"==typeof d&&e>=d-1)return void p(()=>{C(d-1),k(!0)});let s=y.get(e);if(void 0===s)return void p(()=>{C(e-1),k(!1)});if(t+=s,0===i&&t<=x)return void p(()=>{C(i),k(!1)});if(t+30>x)return void p(()=>{C(e-1),k(!0)})}p(()=>{C(i),k(!1)})},[x,y,_,30,p,d]);(0,s.useLayoutEffect)(()=>{A()},[A]);let R=(0,s.useMemo)(()=>j&&void 0!==w?_.slice(0,Math.max(w,0)+1):_,[_,w,j]);return(0,s.useEffect)(()=>()=>{g.current&&clearTimeout(g.current)},[]),(0,s.useEffect)(()=>{x&&y.size===_.length&&requestAnimationFrame(()=>{T(!0)})},[x,y.size,_.length]),(0,t.jsx)("div",{className:(0,a.cn)("flex flex-grow items-center overflow-hidden",N?"opacity-100":"opacity-0","transition-opacity duration-150"),children:(0,t.jsx)("div",{ref:f,className:"flex w-full gap-2",style:{minWidth:0},children:-1===w?(0,t.jsx)(h,{count:_.length,list:_}):(0,t.jsxs)(t.Fragment,{children:[R.map((e,s)=>(0,t.jsx)(u,{className:c,keyAlias:s,tag:e,registerSize:M},s)),(0,t.jsx)("div",{className:(0,a.cn)("flex h-full items-end","".concat(R.length<_.length?"":"hidden")),children:(0,t.jsx)(h,{count:R.length+1,list:_})})]})})})});m.displayName="Overflow"},513959,e=>{"use strict";e.s(["HeartCrack",()=>s,"HeartCrackIcon",()=>i]);var t=e.i(843476);function s(e){let{fillIcon:s,...i}=e;return(0,t.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:s?"currentColor":"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...i,children:[(0,t.jsx)("path",{d:"M19 14c1.49-1.46 3-3.21 3-5.5A5.5 5.5 0 0 0 16.5 3c-1.76 0-3 .5-4.5 2-1.5-1.5-2.74-2-4.5-2A5.5 5.5 0 0 0 2 8.5c0 2.3 1.5 4.05 3 5.5l7 7Z"}),(0,t.jsx)("path",{d:"m12 13-1-1 2-2-3-3 2-2",className:s?"stroke-white dark:stroke-black":"stroke-gray-1"})]})}function i(e){let{fillIcon:s,...i}=e;return(0,t.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",...i,children:[(0,t.jsx)("path",{d:"M12.6666 9.33333C13.6599 8.36 14.6666 7.19333 14.6666 5.66667C14.6666 4.69421 14.2803 3.76158 13.5926 3.07394C12.905 2.38631 11.9724 2 10.9999 2C9.82658 2 8.99992 2.33333 7.99992 3.33333C6.99992 2.33333 6.17325 2 4.99992 2C4.02746 2 3.09483 2.38631 2.40719 3.07394C1.71956 3.76158 1.33325 4.69421 1.33325 5.66667C1.33325 7.2 2.33325 8.36667 3.33325 9.33333L7.99992 14L12.6666 9.33333Z",stroke:"#5F5F6D",strokeWidth:"1.67",strokeLinecap:"round",strokeLinejoin:"round"}),(0,t.jsx)("path",{d:"M8.00008 8.66665L7.33341 7.99998L8.66675 6.66665L6.66675 4.66665L8.00008 3.33331",stroke:"#5F5F6D",strokeWidth:"1.67",strokeLinecap:"round",strokeLinejoin:"round",className:s?"stroke-white dark:stroke-black":""})]})}},173601,e=>{"use strict";e.s(["VoiceCard",()=>O,"useVoiceCardActions",()=>I],173601);var t=e.i(843476),s=e.i(271645),i=e.i(647163),r=e.i(576167),a=e.i(200997),n=e.i(192049),l=e.i(730062),o=e.i(4272),d=e.i(707621),c=e.i(541071),u=e.i(431343),h=e.i(662031),m=e.i(531278),p=e.i(495242),f=e.i(245046),g=e.i(999445),x=e.i(513959),v=e.i(258679),y=e.i(846696),b=e.i(585264),w=e.i(160889),C=e.i(39839),j=e.i(522016),k=e.i(681846),N=e.i(784273),T=e.i(725626),_=e.i(941855),S=e.i(602596),M=e.i(790830),A=e.i(37727),R=e.i(64585),D=e.i(611995);function U(e){let{children:r,content:a,className:n,side:l="top",align:o="center",defaultOpen:d=!0,onOpenChange:c,borderClassName:u,stepKey:h}=e,{user:m,setUser:p,hasLogin:f}=(0,R.useUser)(),[g,x]=(0,s.useState)(!1),v=(0,s.useRef)(null);return((0,s.useEffect)(()=>{let e=JSON.parse(sessionStorage.getItem("onboarding_record")||"[]");Array.isArray(e)||(e=[]),m?x(![...(null==m?void 0:m.onboarding_record)||[],...e].includes(h)&&d):f||x(!e.includes(h)&&d)},[h,m,d,f]),g)?(0,t.jsxs)("div",{className:"relative",ref:v,children:[r,(0,t.jsxs)("div",{className:(0,i.cn)("absolute z-50 min-w-[16rem] rounded-lg border bg-popover p-4 text-popover-foreground shadow-md outline-none","data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95",u,"top"===l&&"bottom-full mb-3","bottom"===l&&"top-full mt-3","left"===l&&"right-full mr-3","right"===l&&"left-full ml-3","start"===o&&("left"===l||"right"===l?"top-0":"left-0"),"center"===o&&("left"===l||"right"===l?"top-1/2 -translate-y-1/2":"left-1/2 -translate-x-1/2"),"end"===o&&("left"===l||"right"===l?"bottom-0":"right-0"),n),children:[(0,t.jsxs)("button",{onClick:()=>(e=>{if(x(e),!e&&h){let e=JSON.parse(sessionStorage.getItem("onboarding_record")||"[]");Array.isArray(e)||(e=[]);let t=new Set([...e,h]);if(sessionStorage.setItem("onboarding_record",JSON.stringify(Array.from(t))),m){(0,D.pushOnboardingRecord)({user_id:m._id,record:h});let e=new Set([...m.onboarding_record||[],h]);p({...m,onboarding_record:Array.from(e)})}}null==c||c(e)})(!1),className:"absolute right-2 top-2 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100",children:[(0,t.jsx)(A.X,{className:"h-4 w-4"}),(0,t.jsx)("span",{className:"sr-only",children:"Close"})]}),a,(0,t.jsx)("div",{className:(0,i.cn)("absolute h-3 w-3 rotate-45",u,"top"===l&&["bottom-[-6.5px]","border-b border-r","bg-popover"],"bottom"===l&&["top-[-6.5px]","border-l border-t","bg-popover"],"left"===l&&["right-[-6.5px]","border-r border-t","bg-popover"],"right"===l&&["left-[-6.5px]","border-b border-l","bg-popover"],"start"===o&&("left"===l||"right"===l?"top-[15px]":"left-[15px]"),"center"===o&&("left"===l||"right"===l?"top-1/2 -translate-y-1/2":"left-1/2 -translate-x-1/2"),"end"===o&&("left"===l||"right"===l?"bottom-[15px]":"right-[15px]"))})]})]}):r}var P=e.i(558249);let B=function(e){let{avatar:s,user:r,userId:a,time:o,tags:d,samples:c,lng:u=[]}=e,h=d.length>0||u.length>0;return(0,t.jsxs)(n.Timeline,{className:"mt-2",children:[(0,t.jsx)(n.TimeLineUser,{className:"text-xs md:text-sm ".concat(!(null==c?void 0:c.length)&&"max-md:after:content-none"),avatar:s,name:r,userId:a}),(0,t.jsx)(n.TimeLineDate,{className:"max-md:after:content-none",time:o,hasTags:h}),!!(null==c?void 0:c.length)&&(0,t.jsx)(n.TimeLineSamples,{className:"max-md:after:content-none",list:c}),h&&(0,t.jsx)("div",{className:"hidden min-w-0 md:block md:max-w-[24.6875rem] md:flex-1",children:(0,t.jsxs)("div",{className:"flex w-full items-center",children:[(0,t.jsx)("div",{className:"shrink-0",children:(0,t.jsx)("div",{className:"flex gap-2",children:u.map((e,s)=>(0,t.jsx)(l.Badge,{variant:"outline",className:(0,i.cn)("whitespace-nowrap",(0,T.getTagColor)(s)),children:e},s))})}),(0,t.jsx)("div",{className:"w-2 shrink-0"}),(0,t.jsx)("div",{className:"min-w-0 flex-1",children:(0,t.jsx)(T.Overflow,{data:d,maxDisplayCount:3})})]})})]})};function I(e){let[t,i]=s.useState(!1),[r,a]=s.useState(!1),[n,l]=s.useState(!1),[o,d]=s.useState({like:0,mark:0,shared:0}),c=(0,b.useTranslations)("discovery");return s.useEffect(()=>{e&&(i(e.liked),l(e.marked),d({like:e.like_count,mark:e.mark_count,shared:e.shared_count}))},[e]),{like:t,unliked:r,mark:n,count_cache:o,handleLike:function(){e&&(t?v.unLikeModel:v.likeModel)({id:e._id}).then(s=>{t?d({...o,like:o.like-1}):(r&&(0,v.unDislikeModel)({id:e._id}).then(e=>{a(!1)}),d({...o,like:o.like+1})),i(!t)})},handleUnliked:function(){e&&(r?v.unDislikeModel:v.dislikeModel)({id:e._id}).then(s=>{!r&&t&&(0,v.unLikeModel)({id:e._id}).then(e=>{i(!1),d({...o,like:o.like-1})}),a(!r)})},handleMark:function(){e&&(n?v.unMarkModel:v.markModel)({id:e._id}).then(e=>{n?d({...o,mark:o.mark-1}):d({...o,mark:o.mark+1}),l(!n)})},share:function(){if(!e)return;let t="https://fish.audio/m/".concat(e._id);navigator.clipboard.writeText(t),(0,y.toast)(c("copied_title")),(0,v.shareModel)({id:e._id}).then(e=>{d({...o,shared:o.shared+1})})}}}let L=function(e){let{data:s,className:r,...a}=e,{like:n,unliked:l,mark:o,count_cache:d,handleLike:c,handleUnliked:m,handleMark:p,share:v}=I(s),{isCN:y}=(0,_.useEnvironment)();return(0,t.jsxs)("div",{className:(0,i.cn)("flex gap-3 md:gap-6",r),...a,children:[(0,t.jsxs)("div",{className:"flex items-center gap-2 whitespace-nowrap text-xs md:text-sm",children:[(0,t.jsx)(u.Play,{className:"h-4 w-4 shrink-0 text-gray-1 md:h-5 md:w-5"}),(0,t.jsxs)("span",{children:[(0,i.formatThousandthNumber)(s.task_count)," Used"]})]}),!y&&(0,t.jsxs)("div",{className:"flex cursor-pointer items-center gap-2 whitespace-nowrap text-xs md:text-sm",onClick:v,children:[(0,t.jsx)(h.Share2,{className:"h-4 w-4 shrink-0 text-gray-1 md:h-5 md:w-5"}),(0,t.jsxs)("span",{children:[d.shared," Shares"]})]}),(0,t.jsxs)("div",{className:"flex cursor-pointer items-center gap-2",onClick:c,children:[(0,t.jsx)(f.Heart,{className:(0,i.cn)("h-4 w-4 shrink-0 md:h-5 md:w-5",n?"text-red":"text-gray-1"),fillIcon:n}),(0,t.jsx)("span",{className:"text-xs md:text-sm",children:d.like})]}),(0,t.jsx)("div",{className:"flex cursor-pointer items-center gap-2",onClick:m,children:(0,t.jsx)(x.HeartCrack,{className:(0,i.cn)("h-4 w-4 shrink-0 md:h-5 md:w-5",l?"":"text-gray-1"),fillIcon:l})}),(0,t.jsxs)("div",{className:"flex cursor-pointer items-center gap-2",onClick:p,children:[(0,t.jsx)(g.Bookmark,{className:(0,i.cn)("h-4 w-4 shrink-0 md:h-5 md:w-5",o?"":"text-gray-1"),fillIcon:o}),(0,t.jsx)("span",{className:"text-xs md:text-sm",children:d.mark})]})]})},z=function(e){let{data:r,className:a,inner:n,handleUseVoice:l,isFirst:u,preventNavigation:h,...m}=e,p=(0,b.useTranslations)("discovery"),f=(0,w.useRouter)(),[g,x]=s.useState(!1),v=(0,C.useMediaQuery)("(max-width: 768px)"),{user:y}=(0,R.useUser)(),j=(0,t.jsx)("div",{className:"flex flex-col gap-2",children:(0,t.jsx)("div",{className:"flex items-center gap-2",children:(0,t.jsxs)("h4",{className:"font-medium",children:["âœ¨ ",p("try_voice")]})})});return(0,t.jsxs)("div",{className:(0,i.cn)("mt-4 flex flex-col-reverse justify-between md:flex-row md:items-end","md:mt-".concat(n?2:4),a),...m,children:[(0,t.jsxs)("div",{className:"mt-5 flex gap-3 md:mt-0",children:[u?(0,t.jsx)(U,{content:j,defaultOpen:!0,side:"bottom",align:v?"start":"center",className:"min-w-[13rem]",borderClassName:"border-purple-500",stepKey:"discover-use-voice",children:(0,t.jsx)(o.Button,{className:"rounded-xl",size:n?"sm":"default",onClick:()=>{(0,P.track)("discover-use-voice-click",{model_id:r._id},y),null==l||l(r),h||f.push((0,i.getInstantSpeechUrl)(r._id))},children:p("use_voice")})}):(0,t.jsx)(o.Button,{className:"rounded-xl",size:n?"sm":"default",onClick:()=>{null==l||l(r),h||f.push((0,i.getInstantSpeechUrl)(r._id))},children:p("use_voice")}),(0,t.jsxs)(k.DropdownMenu,{modal:!1,children:[(0,t.jsx)(k.DropdownMenuTrigger,{children:(0,t.jsx)(c.MoreHorizontal,{className:"invisible w-fit cursor-pointer group-hover:visible"})}),(0,t.jsx)(k.DropdownMenuPortal,{children:(0,t.jsx)(k.DropdownMenuContent,{align:"start",children:(0,t.jsxs)(k.DropdownMenuItem,{className:"cursor-pointer",onClick:()=>x(!0),children:[(0,t.jsx)("div",{className:"flex h-8 w-8 items-center justify-center rounded-md bg-gray-4 dark:bg-white/10",children:(0,t.jsx)(d.CircleAlert,{className:"w-4 text-gray-1"})}),(0,t.jsx)("span",{className:"ml-4",children:p("report.title")})]})})})]})]}),(0,t.jsx)(L,{data:r}),(0,t.jsx)(N.ReportModel,{link:"https://fish.audio/m/".concat(r._id),open:g,onOpenChange:x})]})},E=function(e){var s,r,a;let{data:n,className:o,handleUseVoice:d,isFirst:c,preventNavigation:u,isDashboard:h,...m}=e;return(0,t.jsxs)("div",{className:(0,i.cn)("flex flex-col items-start justify-between md:hidden",o),...m,children:[!!(null==n||null==(s=n.languages)?void 0:s.length)&&(0,t.jsx)("div",{className:"mt-4 flex gap-2",children:null==n||null==(a=n.languages)||null==(r=a.map)?void 0:r.call(a,(e,s)=>(0,t.jsx)(l.Badge,{type:"outline",className:(0,i.cn)("whitespace-nowrap",(0,T.getTagColor)(s)),children:e},s))}),n.tags.length>0&&(0,t.jsx)("div",{className:"mt-4 w-full min-w-0",children:(0,t.jsx)(T.Overflow,{data:n.tags,maxDisplayCount:5})}),(0,t.jsx)(z,{data:n,handleUseVoice:d,isFirst:c,preventNavigation:u})]})},F=s.forwardRef((e,r)=>{let{className:a,sample:n,index:l,isFirst:o,...d}=e,{isCN:c}=(0,_.useEnvironment)(),h=(0,M.useAudioRef)(),[f,g]=s.useState(!0),{currentPlaying:x,isPlay:v,handlePlayAudio:y}=(0,S.useAudioUniqueControl)(),w=(0,i.formatAudioUrl)(n.audio,c),C=(0,b.useTranslations)("discovery"),j=(0,t.jsxs)("div",{className:(0,i.cn)("flex cursor-pointer items-center gap-2",a),onClick:()=>{if(h.current)try{h.current.paused?y(h.current,!1):y(h.current,!0)}catch(e){console.error(e)}},...d,children:[(0,t.jsx)("audio",{className:"hidden",src:w,controls:!1,onEnded:()=>y(h.current,!0),onError:()=>g(!1),onCanPlayThrough:()=>g(!1),ref:h}),f?(0,t.jsx)(m.Loader2,{className:"h-4 w-4 animate-spin"}):x===h.current&&v?(0,t.jsx)(p.Pause,{className:"h-4 w-4"}):(0,t.jsx)(u.Play,{className:"h-4 w-4"}),(0,t.jsx)("span",{className:"max-w-[min(50vw,320px)] overflow-hidden truncate text-ellipsis whitespace-nowrap text-sm",title:n.text,children:n.text})]}),k=(0,t.jsx)("div",{className:"flex flex-col gap-2",children:(0,t.jsx)("div",{className:"flex items-center gap-2",children:(0,t.jsxs)("h4",{className:"font-medium",children:["ðŸ”Š ",C("preview_sample")]})})});return o&&0===l?(0,t.jsx)(U,{content:k,defaultOpen:!0,side:"top",align:"start",className:"min-w-[18rem]",borderClassName:"border-purple-500",stepKey:"discover-play-sample",children:j}):j});F.displayName="AudioSample";let O=s.forwardRef((e,s)=>{let{className:n,data:l,inner:o,handleUseVoice:d,isFirst:c,preventNavigation:u,isDashboard:h,...m}=e,p=o?"md:h-[6.55rem] md:w-[6.55rem]":"md:h-[7.25rem] md:w-[7.25rem]",f=(0,C.useMediaQuery)("(min-width: 768px)");return(0,t.jsx)(r.Card,{className:(0,i.cn)("group mb-3 rounded-xl",n),...m,children:(0,t.jsxs)(r.CardContent,{className:"flex flex-col p-4 md:p-4",children:[(0,t.jsxs)("div",{className:"flex flex-1",children:[(0,t.jsx)(a.Avatar,{className:(0,i.cn)("mr-3 h-16 w-16 rounded-lg md:mr-4","".concat(p)),children:(0,t.jsx)(a.AvatarImage,{src:(0,i.fetchImage)(l.cover_image,f?128:64),alt:l.title})}),(0,t.jsxs)("div",{className:"flex flex-1 flex-col",children:[(0,t.jsx)(r.CardTitle,{className:(0,i.cn)("max-md:text-base","".concat(f&&o?"mt-0":""),"".concat(o?"text-lg":"")),children:(0,t.jsx)(j.default,{href:h?"/app/m/".concat(l._id):"/m/".concat(l._id),children:l.title})}),(0,t.jsx)(B,{user:l.author.nickname,userId:l.author._id,avatar:l.author.avatar,time:l.created_at,tags:l.tags,samples:l.samples,lng:l.languages}),l.samples&&l.samples.length>0&&(0,t.jsx)("div",{className:"mt-2 flex flex-col space-y-2",children:l.samples.slice(0,3).map((e,s)=>(0,t.jsx)(F,{sample:e,index:s,isFirst:c},s))}),(0,t.jsx)("div",{className:"w-full flex-1"}),(0,t.jsx)(z,{className:"hidden md:flex",data:l,inner:o,handleUseVoice:d,isFirst:c,preventNavigation:u})]})]}),(0,t.jsx)(E,{data:l,handleUseVoice:d,isFirst:c,preventNavigation:u,isDashboard:h})]})})});O.displayName="VoiceCard"}]);