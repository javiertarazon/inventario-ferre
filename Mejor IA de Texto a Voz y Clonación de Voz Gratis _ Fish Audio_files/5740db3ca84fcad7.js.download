(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,639125,e=>{"use strict";e.s(["ListPlus",()=>t.default]);var t=e.i(100286)},86303,e=>{"use strict";e.s(["CollectionAdditionDialog",()=>h]);var t=e.i(843476),s=e.i(585264),a=e.i(4272),r=e.i(681846),i=e.i(64585),n=e.i(703383),o=e.i(672345),l=e.i(846696),c=e.i(160889),d=e.i(647163),u=e.i(639125);let h=e=>{let{modelId:h,className:m,triggerChildren:p,isDashboard:f=!1}=e,g=(0,s.useTranslations)("discovery"),{user:x}=(0,i.useUser)(),v=(0,c.useRouter)(),{value:b}=(0,n.useAsync)(async()=>x?(await (0,o.listVoiceCollection)({})).data.filter(e=>e.user_id===(null==x?void 0:x._id)):[],[x]),y=async e=>{try{await (0,o.addModelToCollection)({id:e,model_id:h}),l.toast.success(g("notification.added_to_collection"))}catch(e){l.toast.error(e.message)}};return(0,t.jsxs)(r.DropdownMenu,{children:[(0,t.jsx)(r.DropdownMenuTrigger,{asChild:!0,children:p||(0,t.jsxs)(a.Button,{size:"sm",variant:"outline",className:"flex items-center gap-2 bg-gradient-to-b from-std-bg-elevated to-std-bg-card shadow-[0px_1px_1px_0px_rgba(14,14,17,0.04),0px_2px_4px_0px_rgba(14,14,17,0.04)]",children:[(0,t.jsx)(u.ListPlus,{className:"h-4 w-4"}),g("add_to_collection_action")]})}),(0,t.jsxs)(r.DropdownMenuContent,{className:(0,d.cn)("border-white/8 rounded-lg border bg-gradient-to-b from-std-bg-elevated to-std-bg-card shadow-[0px_1px_1px_0px_rgba(14,14,17,0.04),0px_2px_4px_0px_rgba(14,14,17,0.04)]",m),align:"end",children:[null==b?void 0:b.map(e=>(0,t.jsx)(r.DropdownMenuItem,{onClick:()=>{y(e._id)},children:g("add_to_collection",{title:e.title})},e._id)),(null!=b?b:[]).length>0&&(0,t.jsx)(r.DropdownMenuSeparator,{}),(0,t.jsx)(r.DropdownMenuItem,{onClick:()=>{v.push(f?"/app/my-library/voice-collections":"/my-library/voice-collections")},children:g("create_new_collection")})]})]})}},365582,e=>{"use strict";e.s(["ThumbsDown",()=>t.default]);var t=e.i(751946)},703383,e=>{"use strict";e.s(["useAsync",()=>a],703383);var t=e.i(271645),s=e.i(540233);function a(e,a){void 0===a&&(a=[]);var r=(0,s.default)(e,a,{loading:!0}),i=r[0],n=r[1];return(0,t.useEffect)(function(){n()},[n]),i}},484023,e=>{"use strict";e.s(["default",()=>t]);let t=(0,e.i(475254).default)("download",[["path",{d:"M12 15V3",key:"m9g1x1"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["path",{d:"m7 10 5 5 5-5",key:"brsn70"}]])},61683,e=>{"use strict";e.s(["useDebounce",()=>s],61683);var t=e.i(271645);function s(e,s,a){void 0===s&&(s=0),void 0===a&&(a=[]);var r,i,n,o,l,c,d,u=(void 0===(r=s)&&(r=0),i=(0,t.useRef)(!1),n=(0,t.useRef)(),o=(0,t.useRef)(e),l=(0,t.useCallback)(function(){return i.current},[]),c=(0,t.useCallback)(function(){i.current=!1,n.current&&clearTimeout(n.current),n.current=setTimeout(function(){i.current=!0,o.current()},r)},[r]),d=(0,t.useCallback)(function(){i.current=null,n.current&&clearTimeout(n.current)},[]),(0,t.useEffect)(function(){o.current=e},[e]),(0,t.useEffect)(function(){return c(),d},[r]),[l,d,c]),h=u[0],m=u[1],p=u[2];return(0,t.useEffect)(p,a),[h,m]}},576173,e=>{"use strict";e.s(["secondToStr",()=>r,"useAudioPlayController",()=>i]);var t=e.i(271645),s=e.i(874183),a=e.i(61683);function r(e){let t=Math.floor(e/60),s=("0"+Math.floor(e%60)).slice(-2);return"".concat(t,":").concat(s)}function i(e){let r=arguments.length>1&&void 0!==arguments[1]&&arguments[1],[i,n]=(0,t.useState)(1),[o,l]=(0,t.useState)(!1),[c,d]=(0,t.useState)(0),[u,h]=(0,t.useState)(-1),m=(0,t.useMemo)(()=>"string"!=typeof e,[e]);function p(){h(e.duration)}function f(){d(e.currentTime)}let g=()=>{null==e||e.play(),l(!0)},x=()=>{null==e||e.pause(),l(!1)};(0,t.useEffect)(()=>{function t(){e instanceof s.AudioPlayer||d(0),l(!1)}if(e)return e instanceof s.AudioPlayer?(e.on("durationUpdate",p),e.on("timeupdate",f),e.on("stop",t),r&&e.on("canplay",g),()=>{null==e||e.pause(),e.off("durationUpdate",p),e.off("timeupdate",f),e.off("stop",t),e.off("canplay",g)}):(e.readyState>=1?p():e.addEventListener("loadedmetadata",p),e.addEventListener("timeupdate",f),e.addEventListener("pause",x),e.addEventListener("ended",t),r&&g(),()=>{e.pause(),e.removeEventListener("loadedmetadata",p),e.removeEventListener("timeupdate",f),e.removeEventListener("pause",x),e.removeEventListener("ended",t)});e instanceof s.AudioPlayer||(d(0),h(-1),l(!1))},[e]),(0,t.useEffect)(()=>{e&&(e.volume=i)},[i,e]);let[v,b]=(0,t.useState)(null);return(0,a.useDebounce)(()=>{e&&null!==v&&(f(),b(null))},200,[v]),{volume:i,isAudioPlayer:m,setVolume:n,isPlaying:o,setIsPlaying:l,currentTime:c,duration:u,play:g,pause:x,changeCurrentTime:function(t){e&&(e.currentTime=t,b(t))}}}},874183,104532,e=>{"use strict";e.s(["AudioPlayer",()=>r],874183);var t=e.i(299749);e.s(["audioContextManager",()=>a],104532);class s{static getInstance(){return s.instance||(s.instance=new s),s.instance}getContext(){return this.context||(this.context=new AudioContext,this.masterGainNode=this.context.createGain(),this.masterGainNode.gain.value=this.volume,this.masterGainNode.connect(this.context.destination)),this.context}getMasterGainNode(){if(!this.masterGainNode){let e=this.getContext();this.masterGainNode=e.createGain(),this.masterGainNode.gain.value=this.volume,this.masterGainNode.connect(e.destination)}return this.masterGainNode}async resumeContext(){let e=this.getContext();"suspended"===e.state&&await e.resume()}async initialize(){if(this.isInitialized)return;let e=this.getContext(),t=e.createBuffer(1,1,22050),s=e.createBufferSource();s.buffer=t,s.connect(this.getMasterGainNode());try{s.start(0),this.isInitialized=!0}catch(e){console.error("Failed to initialize audio:",e)}}setVolume(e){this.volume=e,this.masterGainNode&&(this.masterGainNode.gain.value=e)}constructor(){(0,t._)(this,"context",null),(0,t._)(this,"masterGainNode",null),(0,t._)(this,"volume",1),(0,t._)(this,"isInitialized",!1)}}(0,t._)(s,"instance",void 0);let a=s.getInstance();class r{on(e,t){this.listeners[e]=this.listeners[e].filter(e=>e!==t),this.listeners[e].push(t)}off(e,t){this.listeners[e]=this.listeners[e].filter(e=>e!==t)}emit(e){for(var t=arguments.length,s=Array(t>1?t-1:0),a=1;a<t;a++)s[a-1]=arguments[a];this.listeners[e].forEach(e=>e(...s))}computeTime(){if(0===this.allData.length)return;let e=this.allData.reduce((e,t)=>e+((null==t?void 0:t.length)||0),0);0!==e&&(this.durationCache=e/this.sampleRate,this.emit("durationUpdate",this.durationCache))}tryEmitCanplay(){this.canplayEmitted||(this.emit("canplay"),this.canplayEmitted=!0)}loadDoneHandle(){this.loadDone=!0,this.tryEmitCanplay(),this.emit("loadDone"),this.options.lowPower||this.computeTime()}async downloadByReader(){"wav"===this.format?await this.processWavStream():await this.processMp3Stream()}async processWavStream(){let e=new Uint8Array(0),t=performance.now(),s=-1,a=!1,r={channels:this.channels,sampleRate:this.sampleRate,bitsPerSample:16},i=!1;for(;;){let{done:n,value:o}=await this.reader.read();if(n){this.loadDoneHandle();break}e=this.concatTypedArrays(e,o),o.length;let l=performance.now();if(s<0&&(s=l-t),i){let t=2*Math.floor(e.length/2);if(t>0){let s=e.slice(0,t);e=e.slice(t);let a=new Int16Array(s.buffer,s.byteOffset,s.length/2),r=this.int16ToFloat32(a);this.allData.push(r),this.processedChunks++,this.playQueue&&this.playQueue.push(r),this.processedChunks>=this.minChunksBeforePlay&&this.tryEmitCanplay()}continue}if(!a&&e.length>=44){let t=function(e){let t=String.fromCharCode(...Array.from(e.slice(0,4))),s=String.fromCharCode(...Array.from(e.slice(8,12)));if("RIFF"===t&&"WAVE"===s){let t=new DataView(e.buffer,e.byteOffset,44);return{isValid:!0,format:{channels:t.getUint16(22,!0),sampleRate:t.getUint32(24,!0),bitsPerSample:t.getUint16(34,!0)}}}return{isValid:!1}}(e);t.isValid?(r=t.format,this.sampleRate=r.sampleRate,e=e.slice(44),a=!0):i=!0}if(a){let t=2*Math.floor(e.length/2);if(t>0){let s=e.slice(0,t);e=e.slice(t);let a=new Int16Array(s.buffer,s.byteOffset,s.length/2),r=this.int16ToFloat32(a);this.allData.push(r),this.processedChunks++,this.playQueue&&this.playQueue.push(r),this.processedChunks>=this.minChunksBeforePlay&&this.tryEmitCanplay()}}}}async processMp3Stream(){let{MPEGDecoderWebWorker:t}=await e.A(529605),s=new Uint8Array(0),a=performance.now(),r=-1,i=new t,n=null,o=[];for(;;){let{done:e,value:t}=await this.reader.read();if(e){await Promise.all(o),null==n||n.then(()=>{i.free(),this.loadDoneHandle()});break}s=this.concatTypedArrays(s,t),t.length;let l=performance.now();r<0&&(r=l-a);let c=2*Math.floor(s.length/2),d=s.slice(0,c);s=s.slice(c),n=i.ready.then(()=>{let e=i.decode(d).then(e=>{let{channelData:t}=e,[s]=t;this.allData.push(s),this.processedChunks++,this.playQueue&&this.playQueue.push(s),this.processedChunks>=this.minChunksBeforePlay&&this.tryEmitCanplay()}).catch(e=>{console.error(e)});return o.push(e),e})}}concatTypedArrays(e,t){let s=new Uint8Array(e.length+t.length);return s.set(e,0),s.set(t,e.length),s}int16ToFloat32(e){let t=new Float32Array(e.length);for(let s=0;s<e.length;s++)t[s]=e[s]/32768;return t}timeUpdateFn(){"playing"===this.playStatus&&this.emit("timeupdate",this.currentTime)}async play(){if(await a.initialize(),this.playQueue&&0===this.playQueue.length){var e;return this.loadDone?void this.stop():(null==(e=this.audioContext)||e.suspend(),this.playStatus="pending",void(this.waitTimer=setTimeout(this.play,100)))}this.waitTimer=null,this.playQueue||(this.playQueue=this.allData.slice());let t=null===this.audioContext;null===this.audioContext&&(this.audioContext=a.getContext(),this.timeUpdateTimer=setInterval(this.timeUpdateFn.bind(this),200)),"suspended"===this.audioContext.state&&a.resumeContext(),this.offsetTime=this.audioContext.currentTime;let s=[];for(;this.playQueue.length>0;)s.push(this.playQueue.shift());let r=s.reduce((e,t)=>e+((null==t?void 0:t.length)||0),0);if(0===r){this.waitTimer=setTimeout(this.play,100);return}let i=new Float32Array(r),n=0;s.forEach(e=>{i.set(e,n),n+=e.length});let o=this.audioContext.createBuffer(1,i.length,this.sampleRate);o.copyToChannel(i,0);let l=this.audioContext.createBufferSource();this.currentSource=l,l.buffer=o,l.connect(a.getMasterGainNode()),l.onended=()=>{this.currentSource===l&&"playing"===this.playStatus&&(this.startTime=this.currentTime,setTimeout(()=>{this.play()}))},t?l.start(0,this.startTime):l.start(),this.playStatus="playing"}clearAudioContext(){this.currentSource&&(this.currentSource.stop(),this.currentSource.disconnect(),this.currentSource=null),this.audioContext&&(this.audioContext.suspend(),this.audioContext=null,this.offsetTime=0),this.waitTimer&&clearTimeout(this.waitTimer),this.timeUpdateTimer&&clearInterval(this.timeUpdateTimer),this.playQueue=null}pause(){this.audioContext&&"pending"!==this.playStatus&&(this.startTime=this.currentTime),this.clearAudioContext(),this.playStatus="pause",this.emit("stop")}stop(){this.clearAudioContext(),this.startTime=0,this.playStatus="stop",this.emit("stop"),this.emit("timeupdate",0)}close(){var e;null==(e=this.audioContext)||e.close()}get duration(){return this.durationCache}get volume(){return this.volumeProxy}set volume(e){this.volumeProxy=e,a.setVolume(e)}set currentTime(e){if("playing"===this.playStatus||"pending"===this.playStatus){this.stop(),this.startTime=e,this.play();return}this.startTime=e}get currentTime(){if("playing"===this.playStatus){var e;return((null==(e=this.audioContext)?void 0:e.currentTime)||0)+this.startTime-this.offsetTime}return this.startTime}constructor(e,s={}){(0,t._)(this,"reader",void 0),(0,t._)(this,"options",void 0),(0,t._)(this,"format",void 0),(0,t._)(this,"channels",void 0),(0,t._)(this,"loadDone",void 0),(0,t._)(this,"playQueue",void 0),(0,t._)(this,"allData",void 0),(0,t._)(this,"sampleRate",void 0),(0,t._)(this,"durationCache",void 0),(0,t._)(this,"playStatus",void 0),(0,t._)(this,"canplayEmitted",void 0),(0,t._)(this,"processedChunks",void 0),(0,t._)(this,"minChunksBeforePlay",void 0),(0,t._)(this,"listeners",void 0),(0,t._)(this,"audioContext",void 0),(0,t._)(this,"volumeProxy",void 0),(0,t._)(this,"startTime",void 0),(0,t._)(this,"offsetTime",void 0),(0,t._)(this,"waitTimer",void 0),(0,t._)(this,"timeUpdateTimer",void 0),(0,t._)(this,"currentSource",void 0),this.reader=e,this.options=s,this.format="mp3",this.channels=1,this.loadDone=!1,this.playQueue=null,this.allData=[],this.sampleRate=44100,this.durationCache=-1,this.playStatus="stop",this.canplayEmitted=!1,this.processedChunks=0,this.minChunksBeforePlay=3,this.listeners={loadDone:[],stop:[],durationUpdate:[],timeupdate:[],canplay:[]},this.audioContext=null,this.volumeProxy=1,this.startTime=0,this.offsetTime=0,this.waitTimer=null,this.timeUpdateTimer=null,this.currentSource=null,this.options.sampleRate&&(this.sampleRate=this.options.sampleRate),this.format=this.options.format||"mp3",this.channels=this.options.channels||1,this.downloadByReader(),this.play=this.play.bind(this),this.pause=this.pause.bind(this),this.emit=this.emit.bind(this)}}},465061,e=>{"use strict";e.s(["InstantTaskEventStream",()=>g,"createTTSTask",()=>r,"deleteTask",()=>l,"deleteTaskFeedback",()=>h,"downLoadStats",()=>d,"getCreditTasks",()=>o,"getModelLastUsed",()=>c,"getSelfTask",()=>n,"getTask",()=>i,"getTaskExamples",()=>m,"getTaskShareUrl",()=>f,"postTaskClone",()=>p,"postTaskFeedback",()=>u]);var t=e.i(299749),s=e.i(874183),a=e.i(100574);let r=async e=>{let t=new AbortController,r=setTimeout(()=>t.abort(),36e5),i=await fetch("".concat(a.BASE_URL,"/task"),{method:"POST",headers:{authorization:(0,a.getAuthorization)(),"content-type":"application/json"},body:JSON.stringify({type:"tts",stream:!0,model:e.model,turnstile:e.turnstile,prosody:e.prosody,latency:e.latency,parameters:{text:e.text},recaptcha:e.recaptcha,format:"mp3",backend:e.backend,sampler:e.sampler}),signal:t.signal});if(clearTimeout(r),401==i.status&&(0,a.handle401)(),!i.ok)if(i.status>=400&&i.status<500)(0,a.handle4xx)(await i.json());else throw Error("Unknown error occurred");let n=i.body.getReader();return i.headers.forEach((e,t)=>{console.log(t,e)}),{taskId:i.headers.get("task-id"),audio:new s.AudioPlayer(n)}},i=a.fetcher.path("/task/{task_id}").method("get").create(),n=a.fetcher.path("/task").method("get").create(),o=a.fetcher.path("/task/usage").method("get").create(),l=a.fetcher.path("/task").method("delete").create(),c=a.fetcher.path("/model/latest-used").method("get").create(),d=a.fetcher.path("/task/download-stats").method("post").create(),u=a.fetcher.path("/task/{task_id}/feedback").method("post").create(),h=a.fetcher.path("/task/{task_id}/feedback").method("delete").create(),m=a.fetcher.path("/task/example").method("get").create(),p=a.fetcher.path("/task/{task_id}/clone").method("post").create(),f=a.fetcher.path("/task/{task_id}/share-url").method("get").create();class g{async start(e){try{this.abortController=new AbortController;let t="".concat(a.BASE_URL,"/task/instant"),s=new FormData;s.append("audio",e.audio),e.recaptcha&&s.append("recaptcha",e.recaptcha);let r=await fetch(t,{method:"POST",headers:{Authorization:(0,a.getAuthorization)(),Accept:"text/event-stream"},body:s,signal:this.abortController.signal});if(!r.ok)throw Error("".concat(r.status," ").concat(r.statusText));if(!r.body)throw Error("response body is empty");this.isProcessing=!0,this.processStream(r.body)}catch(e){var t,s;throw null==(t=(s=this.callbacks).onError)||t.call(s,e),e}}async processStream(e){var t,s,a,r;let i=e.getReader(),n=new TextDecoder,o="";try{for(;this.isProcessing;){let{value:e,done:a}=await i.read();if(a)break;o+=n.decode(e,{stream:!0});let r=this.extractEvents(o);for(let e of(o=r.remainder,r.events))try{if(e.startsWith("data: ")){let t=e.slice(6),s=JSON.parse(t);this.handleEvent(s)}}catch(a){console.error(a,e),null==(t=(s=this.callbacks).onError)||t.call(s,a)}}}catch(e){"AbortError"!==e.name&&(console.error(e),null==(a=(r=this.callbacks).onError)||a.call(r,e))}finally{i.releaseLock()}}extractEvents(e){let t=e.split("\n\n");return{events:t.slice(0,-1),remainder:t[t.length-1]}}handleEvent(e){var t,s,a,r,i,n,o,l,c,d,u,h,m,p,f,g,x,v,b,y,w,k;let{message:C,duration:_,text:j,language:T,audio:N,alignment:S,type:A}=e;switch(C){case"asr_started":null==(t=(s=this.callbacks).onAsrStarted)||t.call(s);break;case"asr_finished":null==(a=(r=this.callbacks).onAsrFinished)||a.call(r,_||0,j||"",T);break;case"random_text_generation_started":null==(i=(n=this.callbacks).onRandomTextGenerationStarted)||i.call(n);break;case"random_text_generation_finished":null==(o=(l=this.callbacks).onRandomTextGenerationFinished)||o.call(l,j||"");break;case"tts_generation_started":null==(c=(d=this.callbacks).onTtsGenerationStarted)||c.call(d);break;case"tts_generation_finished":null==(u=(h=this.callbacks).onTtsGenerationFinished)||u.call(h);break;case"alignment_generation_started":null==(m=(p=this.callbacks).onAlignmentGenerationStarted)||m.call(p);break;case"alignment_generation_finished":null==(f=(g=this.callbacks).onAlignmentGenerationFinished)||f.call(g);break;case"tts_audio_and_alignment_generation_finished":null==(x=(v=this.callbacks).onTtsAudioAndAlignmentFinished)||x.call(v,N||"",S);break;case"asr_internal_error":null==(b=(y=this.callbacks).onError)||b.call(y,e);break;default:"error"===A?null==(w=(k=this.callbacks).onError)||w.call(k,e):console.log("unhandled event:",C)}}close(){this.isProcessing=!1,this.abortController&&(this.abortController.abort(),this.abortController=null)}constructor(e={}){(0,t._)(this,"abortController",null),(0,t._)(this,"callbacks",void 0),(0,t._)(this,"isProcessing",!1),this.callbacks=e}}},100286,e=>{"use strict";e.s(["default",()=>t]);let t=(0,e.i(475254).default)("list-plus",[["path",{d:"M16 5H3",key:"m91uny"}],["path",{d:"M11 12H3",key:"51ecnj"}],["path",{d:"M16 19H3",key:"zzsher"}],["path",{d:"M18 9v6",key:"1twb98"}],["path",{d:"M21 12h-6",key:"bt1uis"}]])},751946,e=>{"use strict";e.s(["default",()=>t]);let t=(0,e.i(475254).default)("thumbs-down",[["path",{d:"M9 18.12 10 14H4.17a2 2 0 0 1-1.92-2.56l2.33-8A2 2 0 0 1 6.5 2H20a2 2 0 0 1 2 2v8a2 2 0 0 1-2 2h-2.76a2 2 0 0 0-1.79 1.11L12 22a3.13 3.13 0 0 1-3-3.88Z",key:"m61m77"}],["path",{d:"M17 14V2",key:"8ymqnk"}]])},751552,e=>{"use strict";e.s(["useAudioDownload",()=>c]);var t=e.i(271645),s=e.i(678631),a=e.i(846696),r=e.i(585264),i=e.i(647163),n=e.i(941855),o=e.i(874183),l=e.i(465061);function c(){let{isCN:e}=(0,n.useEnvironment)(),c=(0,r.useTranslations)("text-to-speech");return{downloadAudio:(0,t.useCallback)(async function(t){let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{taskId:n,modelTitle:d,text:u,onSuccess:h,onError:m}=r,p=null;if(!t)return void a.toast.error(c("download_source_error"));if("string"==typeof t)p=t;else if(t instanceof HTMLAudioElement)p=t.src;else if(t instanceof o.AudioPlayer){if(!n)return void a.toast.error(c("download_source_error"));try{let e=await (0,l.getTask)({task_id:n});if("finished"!==e.data.state||!("result"in e.data))return void a.toast.error(c("download_source_error"));p=e.data.result}catch(e){console.error("Failed to fetch task result:",e),a.toast.error(c("download_failed")),null==m||m(e);return}}if(!p)return void a.toast.error(c("download_source_error"));try{let t=(0,i.formatAudioUrl)(p,e),a=(0,i.generateFileName)(d||"audio",u||"generated"),r=await fetch(t,{mode:"cors",credentials:"omit"});if(!r.ok)throw Error("Failed to fetch audio: ".concat(r.status," ").concat(r.statusText));let n=await r.blob();(0,s.default)(n,a),null==h||h()}catch(e){console.error("Download error:",e),a.toast.error(c("download_failed")),null==m||m(e)}},[e,c])}}},672345,e=>{"use strict";e.s(["addModelToCollection",()=>l,"createVoiceCollection",()=>s,"deleteCollectionModel",()=>o,"deleteVoiceCollection",()=>i,"followCollection",()=>c,"getCollectionModels",()=>n,"listVoiceCollection",()=>a,"unfollowCollection",()=>d,"updateVoiceCollection",()=>r]);var t=e.i(100574);let s=t.fetcher.path("/collection").method("post").create(),a=t.fetcher.path("/collection").method("get").create();t.fetcher.path("/collection/{id}").method("get").create(),t.fetcher.path("/collection/{id}").method("get").create();let r=t.fetcher.path("/collection/{id}").method("put").create(),i=t.fetcher.path("/collection/{id}").method("delete").create(),n=t.fetcher.path("/collection/{id}/models").method("get").create(),o=t.fetcher.path("/collection/{id}/models/{model_id}").method("delete").create(),l=t.fetcher.path("/collection/{id}/models/{model_id}").method("post").create(),c=t.fetcher.path("/collection/{id}/follow").method("post").create(),d=t.fetcher.path("/collection/{id}/follow").method("delete").create()},495242,361839,e=>{"use strict";e.s(["Pause",()=>t],495242),e.s(["default",()=>t],361839);let t=(0,e.i(475254).default)("pause",[["rect",{x:"14",y:"3",width:"5",height:"18",rx:"1",key:"kaeet6"}],["rect",{x:"5",y:"3",width:"5",height:"18",rx:"1",key:"1wsw3u"}]])},431343,451477,e=>{"use strict";e.s(["Play",()=>t],431343),e.s(["default",()=>t],451477);let t=(0,e.i(475254).default)("play",[["path",{d:"M5 5a2 2 0 0 1 3.008-1.728l11.997 6.998a2 2 0 0 1 .003 3.458l-12 7A2 2 0 0 1 5 19z",key:"10ikf1"}]])},541071,373488,e=>{"use strict";e.s(["MoreHorizontal",()=>t],541071),e.s(["default",()=>t],373488);let t=(0,e.i(475254).default)("ellipsis",[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"19",cy:"12",r:"1",key:"1wjl8i"}],["circle",{cx:"5",cy:"12",r:"1",key:"1pcz8c"}]])},730062,e=>{"use strict";e.s(["Badge",()=>i]);var t=e.i(843476),s=e.i(225913),a=e.i(647163);let r=(0,s.cva)("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground"},type:{outline:"rounded-md",square:"rounded-md",circle:"rounded-full","outline-circle":"rounded-full"},theme:{default:"",info:"bg-badge-info-ground text-badge-info-text hover:bg-info-ground",blue:"bg-badge-blue-ground text-badge-blue-text hover:bg-blue-ground",destructive:"bg-badge-destructive-ground text-badge-destructive-text hover:bg-destructive-ground",success:"bg-badge-success-ground text-badge-success-text hover:bg-success-ground"}},compoundVariants:[{theme:"blue",type:["outline","outline-circle"],class:"border-badge-blue-border border bg-badge-blue-outlineground text-badge-blue-outlinetext hover:bg-blue-outlineground"},{theme:"success",type:["outline","outline-circle"],class:"border-badge-success-border border bg-badge-success-outlineground text-badge-success-outlinetext hover:bg-success-outlineground"},{theme:"destructive",type:["outline","outline-circle"],class:"border-badge-destructive-border border bg-badge-destructive-outlineground text-badge-destructive-outlinetext hover:bg-destructive-outlineground"},{theme:"info",type:["outline","outline-circle"],class:"border-badge-info-border border bg-badge-info-outlineground text-badge-info-outlinetext hover:bg-info-outlineground"}],defaultVariants:{variant:"default",type:"circle"}});function i(e){let{className:s,variant:i,type:n,theme:o,...l}=e;return(0,t.jsx)("div",{className:(0,a.cn)(r({variant:i,type:n,theme:o}),s),...l})}},245046,e=>{"use strict";e.s(["Heart",()=>s]);var t=e.i(843476);function s(e){let{fillIcon:s,...a}=e;return(0,t.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 20 20",...a,children:(0,t.jsx)("path",{d:"M6.24984 3.33325C3.71859 3.33325 1.6665 5.38534 1.6665 7.91659C1.6665 12.4999 7.08317 16.6666 9.99984 17.6358C12.9165 16.6666 18.3332 12.4999 18.3332 7.91659C18.3332 5.38534 16.2811 3.33325 13.7498 3.33325C12.1998 3.33325 10.829 4.10284 9.99984 5.28075C9.5772 4.67876 9.01574 4.18746 8.36298 3.84846C7.71021 3.50945 6.98538 3.33273 6.24984 3.33325Z",stroke:"currentColor",fill:s?"currentColor":"none",strokeWidth:"1.66667",strokeLinecap:"round",strokeLinejoin:"round"})})}},513959,e=>{"use strict";e.s(["HeartCrack",()=>s,"HeartCrackIcon",()=>a]);var t=e.i(843476);function s(e){let{fillIcon:s,...a}=e;return(0,t.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:s?"currentColor":"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...a,children:[(0,t.jsx)("path",{d:"M19 14c1.49-1.46 3-3.21 3-5.5A5.5 5.5 0 0 0 16.5 3c-1.76 0-3 .5-4.5 2-1.5-1.5-2.74-2-4.5-2A5.5 5.5 0 0 0 2 8.5c0 2.3 1.5 4.05 3 5.5l7 7Z"}),(0,t.jsx)("path",{d:"m12 13-1-1 2-2-3-3 2-2",className:s?"stroke-white dark:stroke-black":"stroke-gray-1"})]})}function a(e){let{fillIcon:s,...a}=e;return(0,t.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",...a,children:[(0,t.jsx)("path",{d:"M12.6666 9.33333C13.6599 8.36 14.6666 7.19333 14.6666 5.66667C14.6666 4.69421 14.2803 3.76158 13.5926 3.07394C12.905 2.38631 11.9724 2 10.9999 2C9.82658 2 8.99992 2.33333 7.99992 3.33333C6.99992 2.33333 6.17325 2 4.99992 2C4.02746 2 3.09483 2.38631 2.40719 3.07394C1.71956 3.76158 1.33325 4.69421 1.33325 5.66667C1.33325 7.2 2.33325 8.36667 3.33325 9.33333L7.99992 14L12.6666 9.33333Z",stroke:"#5F5F6D",strokeWidth:"1.67",strokeLinecap:"round",strokeLinejoin:"round"}),(0,t.jsx)("path",{d:"M8.00008 8.66665L7.33341 7.99998L8.66675 6.66665L6.66675 4.66665L8.00008 3.33331",stroke:"#5F5F6D",strokeWidth:"1.67",strokeLinecap:"round",strokeLinejoin:"round",className:s?"stroke-white dark:stroke-black":""})]})}},725626,e=>{"use strict";e.s(["Overflow",()=>m,"getTagColor",()=>d],725626);var t=e.i(843476),s=e.i(271645),a=e.i(730062),r=e.i(39839),i=e.i(647163),n=e.i(174080),o=e.i(129160),l=e.i(585264),c=e.i(162353);let d=e=>{let t=[{key:"green",class:"text-discovery-tag-green-text border-discovery-tag-green-border bg-discovery-tag-green-ground border"},{key:"cyan",class:"text-discovery-tag-cyan-text border-discovery-tag-cyan-border bg-discovery-tag-cyan-ground border"},{key:"amber",class:"text-discovery-tag-amber-text border-discovery-tag-amber-border bg-discovery-tag-amber-ground  border"},{key:"neutral",class:"text-discovery-tag-neutral-text border-discovery-tag-neutral-border bg-discovery-tag-neutral-ground border"}];return t[e%t.length].class},u=(0,s.forwardRef)((e,n)=>{let{className:o,keyAlias:u,tag:h,registerSize:m,...p}=e,f=(0,s.useRef)(null),g=(0,l.useTranslations)("train-new-model.suggested-tags");return(0,r.useResizeObserver)({ref:f,onResize:e=>{let{width:t}=e;return m(u,t?t+8:0)}}),(0,t.jsx)("div",{ref:f,children:(0,t.jsx)(a.Badge,{variant:"outline",theme:"success",className:(0,i.cn)("whitespace-nowrap",d(u),o),children:(0,c.getTagLabel)(h,g)})})});u.displayName="OverflowItem";let h=(0,s.forwardRef)((e,s)=>{let{className:r,count:n,list:u,...h}=e,m=(0,l.useTranslations)("discovery"),p=(0,l.useTranslations)("train-new-model.suggested-tags");return(0,t.jsxs)(o.Popover,{children:[(0,t.jsx)(o.PopoverTrigger,{children:(0,t.jsx)(a.Badge,{variant:"outline",children:(0,t.jsxs)("span",{children:[n,"+"]})})}),(0,t.jsx)(o.PopoverContent,{align:"end",className:"md:w-[25.125rem]",children:(0,t.jsxs)("div",{children:[(0,t.jsx)("div",{className:"font-semiblod text-xl",children:m("all_tags")}),(0,t.jsx)("div",{className:"mt-4 flex flex-wrap gap-2",children:u.map((e,s)=>(0,t.jsx)(a.Badge,{variant:"outline",className:(0,i.cn)("whitespace-nowrap",d(s)),children:(0,c.getTagLabel)(e,p)},s))})]})})]})});h.displayName="TagsPoppover";let m=(0,s.forwardRef)((e,a)=>{let{className:o,data:l,maxDisplayCount:c,itemClassName:d,...m}=e,p=function(){let e=(0,s.useRef)(null);return t=>{e.current||(e.current=[],Promise.resolve().then(()=>{(0,n.unstable_batchedUpdates)(()=>{var t;null==(t=e.current)||t.forEach(e=>{e()}),e.current=null})})),e.current.push(t)}}(),f=(0,s.useRef)(null),g=(0,s.useRef)(void 0),[x,v]=(0,s.useState)(0),[b,y]=(0,s.useState)(new Map),[w,k]=(0,s.useState)(),[C,_]=(0,s.useState)(!1),[j,T]=(0,s.useState)(!1),N=(0,s.useMemo)(()=>l.filter(Boolean),[l]),S=(0,s.useCallback)(e=>{let{width:t}=e;g.current&&clearTimeout(g.current),g.current=setTimeout(()=>{p(()=>{v(t||0)})},16)},[p]);(0,r.useResizeObserver)({ref:f,onResize:S});let A=(0,s.useCallback)((e,t)=>{p(()=>{y(s=>{let a=new Map(s);return null===t?a.delete(e):a.set(e,t),a})})},[p]),M=(0,s.useCallback)(()=>{if(!x||0===b.size)return void p(()=>{k(0),_(!1)});let e=b.get(0);if(e&&e>x)return void p(()=>{k(-1),_(!0)});let t=0,s=N.length,a=s-1;if(!s)return void p(()=>{k(0),_(!1)});for(let e=0;e<s;e+=1){if("number"==typeof c&&e>=c-1)return void p(()=>{k(c-1),_(!0)});let s=b.get(e);if(void 0===s)return void p(()=>{k(e-1),_(!1)});if(t+=s,0===a&&t<=x)return void p(()=>{k(a),_(!1)});if(t+30>x)return void p(()=>{k(e-1),_(!0)})}p(()=>{k(a),_(!1)})},[x,b,N,30,p,c]);(0,s.useLayoutEffect)(()=>{M()},[M]);let E=(0,s.useMemo)(()=>C&&void 0!==w?N.slice(0,Math.max(w,0)+1):N,[N,w,C]);return(0,s.useEffect)(()=>()=>{g.current&&clearTimeout(g.current)},[]),(0,s.useEffect)(()=>{x&&b.size===N.length&&requestAnimationFrame(()=>{T(!0)})},[x,b.size,N.length]),(0,t.jsx)("div",{className:(0,i.cn)("flex flex-grow items-center overflow-hidden",j?"opacity-100":"opacity-0","transition-opacity duration-150"),children:(0,t.jsx)("div",{ref:f,className:"flex w-full gap-2",style:{minWidth:0},children:-1===w?(0,t.jsx)(h,{count:N.length,list:N}):(0,t.jsxs)(t.Fragment,{children:[E.map((e,s)=>(0,t.jsx)(u,{className:d,keyAlias:s,tag:e,registerSize:A},s)),(0,t.jsx)("div",{className:(0,i.cn)("flex h-full items-end","".concat(E.length<N.length?"":"hidden")),children:(0,t.jsx)(h,{count:E.length+1,list:N})})]})})})});m.displayName="Overflow"},173601,e=>{"use strict";e.s(["VoiceCard",()=>I,"useVoiceCardActions",()=>P],173601);var t=e.i(843476),s=e.i(271645),a=e.i(647163),r=e.i(576167),i=e.i(200997),n=e.i(192049),o=e.i(730062),l=e.i(4272),c=e.i(707621),d=e.i(541071),u=e.i(431343),h=e.i(662031),m=e.i(531278),p=e.i(495242),f=e.i(245046),g=e.i(999445),x=e.i(513959),v=e.i(258679),b=e.i(846696),y=e.i(585264),w=e.i(160889),k=e.i(39839),C=e.i(522016),_=e.i(681846),j=e.i(784273),T=e.i(725626),N=e.i(941855),S=e.i(602596),A=e.i(790830),M=e.i(37727),E=e.i(64585),R=e.i(611995);function L(e){let{children:r,content:i,className:n,side:o="top",align:l="center",defaultOpen:c=!0,onOpenChange:d,borderClassName:u,stepKey:h}=e,{user:m,setUser:p,hasLogin:f}=(0,E.useUser)(),[g,x]=(0,s.useState)(!1),v=(0,s.useRef)(null);return((0,s.useEffect)(()=>{let e=JSON.parse(sessionStorage.getItem("onboarding_record")||"[]");Array.isArray(e)||(e=[]),m?x(![...(null==m?void 0:m.onboarding_record)||[],...e].includes(h)&&c):f||x(!e.includes(h)&&c)},[h,m,c,f]),g)?(0,t.jsxs)("div",{className:"relative",ref:v,children:[r,(0,t.jsxs)("div",{className:(0,a.cn)("absolute z-50 min-w-[16rem] rounded-lg border bg-popover p-4 text-popover-foreground shadow-md outline-none","data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95",u,"top"===o&&"bottom-full mb-3","bottom"===o&&"top-full mt-3","left"===o&&"right-full mr-3","right"===o&&"left-full ml-3","start"===l&&("left"===o||"right"===o?"top-0":"left-0"),"center"===l&&("left"===o||"right"===o?"top-1/2 -translate-y-1/2":"left-1/2 -translate-x-1/2"),"end"===l&&("left"===o||"right"===o?"bottom-0":"right-0"),n),children:[(0,t.jsxs)("button",{onClick:()=>(e=>{if(x(e),!e&&h){let e=JSON.parse(sessionStorage.getItem("onboarding_record")||"[]");Array.isArray(e)||(e=[]);let t=new Set([...e,h]);if(sessionStorage.setItem("onboarding_record",JSON.stringify(Array.from(t))),m){(0,R.pushOnboardingRecord)({user_id:m._id,record:h});let e=new Set([...m.onboarding_record||[],h]);p({...m,onboarding_record:Array.from(e)})}}null==d||d(e)})(!1),className:"absolute right-2 top-2 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100",children:[(0,t.jsx)(M.X,{className:"h-4 w-4"}),(0,t.jsx)("span",{className:"sr-only",children:"Close"})]}),i,(0,t.jsx)("div",{className:(0,a.cn)("absolute h-3 w-3 rotate-45",u,"top"===o&&["bottom-[-6.5px]","border-b border-r","bg-popover"],"bottom"===o&&["top-[-6.5px]","border-l border-t","bg-popover"],"left"===o&&["right-[-6.5px]","border-r border-t","bg-popover"],"right"===o&&["left-[-6.5px]","border-b border-l","bg-popover"],"start"===l&&("left"===o||"right"===o?"top-[15px]":"left-[15px]"),"center"===l&&("left"===o||"right"===o?"top-1/2 -translate-y-1/2":"left-1/2 -translate-x-1/2"),"end"===l&&("left"===o||"right"===o?"bottom-[15px]":"right-[15px]"))})]})]}):r}var D=e.i(558249);let U=function(e){let{avatar:s,user:r,userId:i,time:l,tags:c,samples:d,lng:u=[]}=e,h=c.length>0||u.length>0;return(0,t.jsxs)(n.Timeline,{className:"mt-2",children:[(0,t.jsx)(n.TimeLineUser,{className:"text-xs md:text-sm ".concat(!(null==d?void 0:d.length)&&"max-md:after:content-none"),avatar:s,name:r,userId:i}),(0,t.jsx)(n.TimeLineDate,{className:"max-md:after:content-none",time:l,hasTags:h}),!!(null==d?void 0:d.length)&&(0,t.jsx)(n.TimeLineSamples,{className:"max-md:after:content-none",list:d}),h&&(0,t.jsx)("div",{className:"hidden min-w-0 md:block md:max-w-[24.6875rem] md:flex-1",children:(0,t.jsxs)("div",{className:"flex w-full items-center",children:[(0,t.jsx)("div",{className:"shrink-0",children:(0,t.jsx)("div",{className:"flex gap-2",children:u.map((e,s)=>(0,t.jsx)(o.Badge,{variant:"outline",className:(0,a.cn)("whitespace-nowrap",(0,T.getTagColor)(s)),children:e},s))})}),(0,t.jsx)("div",{className:"w-2 shrink-0"}),(0,t.jsx)("div",{className:"min-w-0 flex-1",children:(0,t.jsx)(T.Overflow,{data:c,maxDisplayCount:3})})]})})]})};function P(e){let[t,a]=s.useState(!1),[r,i]=s.useState(!1),[n,o]=s.useState(!1),[l,c]=s.useState({like:0,mark:0,shared:0}),d=(0,y.useTranslations)("discovery");return s.useEffect(()=>{e&&(a(e.liked),o(e.marked),c({like:e.like_count,mark:e.mark_count,shared:e.shared_count}))},[e]),{like:t,unliked:r,mark:n,count_cache:l,handleLike:function(){e&&(t?v.unLikeModel:v.likeModel)({id:e._id}).then(s=>{t?c({...l,like:l.like-1}):(r&&(0,v.unDislikeModel)({id:e._id}).then(e=>{i(!1)}),c({...l,like:l.like+1})),a(!t)})},handleUnliked:function(){e&&(r?v.unDislikeModel:v.dislikeModel)({id:e._id}).then(s=>{!r&&t&&(0,v.unLikeModel)({id:e._id}).then(e=>{a(!1),c({...l,like:l.like-1})}),i(!r)})},handleMark:function(){e&&(n?v.unMarkModel:v.markModel)({id:e._id}).then(e=>{n?c({...l,mark:l.mark-1}):c({...l,mark:l.mark+1}),o(!n)})},share:function(){if(!e)return;let t="https://fish.audio/m/".concat(e._id);navigator.clipboard.writeText(t),(0,b.toast)(d("copied_title")),(0,v.shareModel)({id:e._id}).then(e=>{c({...l,shared:l.shared+1})})}}}let F=function(e){let{data:s,className:r,...i}=e,{like:n,unliked:o,mark:l,count_cache:c,handleLike:d,handleUnliked:m,handleMark:p,share:v}=P(s),{isCN:b}=(0,N.useEnvironment)();return(0,t.jsxs)("div",{className:(0,a.cn)("flex gap-3 md:gap-6",r),...i,children:[(0,t.jsxs)("div",{className:"flex items-center gap-2 whitespace-nowrap text-xs md:text-sm",children:[(0,t.jsx)(u.Play,{className:"h-4 w-4 shrink-0 text-gray-1 md:h-5 md:w-5"}),(0,t.jsxs)("span",{children:[(0,a.formatThousandthNumber)(s.task_count)," Used"]})]}),!b&&(0,t.jsxs)("div",{className:"flex cursor-pointer items-center gap-2 whitespace-nowrap text-xs md:text-sm",onClick:v,children:[(0,t.jsx)(h.Share2,{className:"h-4 w-4 shrink-0 text-gray-1 md:h-5 md:w-5"}),(0,t.jsxs)("span",{children:[c.shared," Shares"]})]}),(0,t.jsxs)("div",{className:"flex cursor-pointer items-center gap-2",onClick:d,children:[(0,t.jsx)(f.Heart,{className:(0,a.cn)("h-4 w-4 shrink-0 md:h-5 md:w-5",n?"text-red":"text-gray-1"),fillIcon:n}),(0,t.jsx)("span",{className:"text-xs md:text-sm",children:c.like})]}),(0,t.jsx)("div",{className:"flex cursor-pointer items-center gap-2",onClick:m,children:(0,t.jsx)(x.HeartCrack,{className:(0,a.cn)("h-4 w-4 shrink-0 md:h-5 md:w-5",o?"":"text-gray-1"),fillIcon:o})}),(0,t.jsxs)("div",{className:"flex cursor-pointer items-center gap-2",onClick:p,children:[(0,t.jsx)(g.Bookmark,{className:(0,a.cn)("h-4 w-4 shrink-0 md:h-5 md:w-5",l?"":"text-gray-1"),fillIcon:l}),(0,t.jsx)("span",{className:"text-xs md:text-sm",children:c.mark})]})]})},B=function(e){let{data:r,className:i,inner:n,handleUseVoice:o,isFirst:u,preventNavigation:h,...m}=e,p=(0,y.useTranslations)("discovery"),f=(0,w.useRouter)(),[g,x]=s.useState(!1),v=(0,k.useMediaQuery)("(max-width: 768px)"),{user:b}=(0,E.useUser)(),C=(0,t.jsx)("div",{className:"flex flex-col gap-2",children:(0,t.jsx)("div",{className:"flex items-center gap-2",children:(0,t.jsxs)("h4",{className:"font-medium",children:["âœ¨ ",p("try_voice")]})})});return(0,t.jsxs)("div",{className:(0,a.cn)("mt-4 flex flex-col-reverse justify-between md:flex-row md:items-end","md:mt-".concat(n?2:4),i),...m,children:[(0,t.jsxs)("div",{className:"mt-5 flex gap-3 md:mt-0",children:[u?(0,t.jsx)(L,{content:C,defaultOpen:!0,side:"bottom",align:v?"start":"center",className:"min-w-[13rem]",borderClassName:"border-purple-500",stepKey:"discover-use-voice",children:(0,t.jsx)(l.Button,{className:"rounded-xl",size:n?"sm":"default",onClick:()=>{(0,D.track)("discover-use-voice-click",{model_id:r._id},b),null==o||o(r),h||f.push((0,a.getInstantSpeechUrl)(r._id))},children:p("use_voice")})}):(0,t.jsx)(l.Button,{className:"rounded-xl",size:n?"sm":"default",onClick:()=>{null==o||o(r),h||f.push((0,a.getInstantSpeechUrl)(r._id))},children:p("use_voice")}),(0,t.jsxs)(_.DropdownMenu,{modal:!1,children:[(0,t.jsx)(_.DropdownMenuTrigger,{children:(0,t.jsx)(d.MoreHorizontal,{className:"invisible w-fit cursor-pointer group-hover:visible"})}),(0,t.jsx)(_.DropdownMenuPortal,{children:(0,t.jsx)(_.DropdownMenuContent,{align:"start",children:(0,t.jsxs)(_.DropdownMenuItem,{className:"cursor-pointer",onClick:()=>x(!0),children:[(0,t.jsx)("div",{className:"flex h-8 w-8 items-center justify-center rounded-md bg-gray-4 dark:bg-white/10",children:(0,t.jsx)(c.CircleAlert,{className:"w-4 text-gray-1"})}),(0,t.jsx)("span",{className:"ml-4",children:p("report.title")})]})})})]})]}),(0,t.jsx)(F,{data:r}),(0,t.jsx)(j.ReportModel,{link:"https://fish.audio/m/".concat(r._id),open:g,onOpenChange:x})]})},O=function(e){var s,r,i;let{data:n,className:l,handleUseVoice:c,isFirst:d,preventNavigation:u,isDashboard:h,...m}=e;return(0,t.jsxs)("div",{className:(0,a.cn)("flex flex-col items-start justify-between md:hidden",l),...m,children:[!!(null==n||null==(s=n.languages)?void 0:s.length)&&(0,t.jsx)("div",{className:"mt-4 flex gap-2",children:null==n||null==(i=n.languages)||null==(r=i.map)?void 0:r.call(i,(e,s)=>(0,t.jsx)(o.Badge,{type:"outline",className:(0,a.cn)("whitespace-nowrap",(0,T.getTagColor)(s)),children:e},s))}),n.tags.length>0&&(0,t.jsx)("div",{className:"mt-4 w-full min-w-0",children:(0,t.jsx)(T.Overflow,{data:n.tags,maxDisplayCount:5})}),(0,t.jsx)(B,{data:n,handleUseVoice:c,isFirst:d,preventNavigation:u})]})},z=s.forwardRef((e,r)=>{let{className:i,sample:n,index:o,isFirst:l,...c}=e,{isCN:d}=(0,N.useEnvironment)(),h=(0,A.useAudioRef)(),[f,g]=s.useState(!0),{currentPlaying:x,isPlay:v,handlePlayAudio:b}=(0,S.useAudioUniqueControl)(),w=(0,a.formatAudioUrl)(n.audio,d),k=(0,y.useTranslations)("discovery"),C=(0,t.jsxs)("div",{className:(0,a.cn)("flex cursor-pointer items-center gap-2",i),onClick:()=>{if(h.current)try{h.current.paused?b(h.current,!1):b(h.current,!0)}catch(e){console.error(e)}},...c,children:[(0,t.jsx)("audio",{className:"hidden",src:w,controls:!1,onEnded:()=>b(h.current,!0),onError:()=>g(!1),onCanPlayThrough:()=>g(!1),ref:h}),f?(0,t.jsx)(m.Loader2,{className:"h-4 w-4 animate-spin"}):x===h.current&&v?(0,t.jsx)(p.Pause,{className:"h-4 w-4"}):(0,t.jsx)(u.Play,{className:"h-4 w-4"}),(0,t.jsx)("span",{className:"max-w-[min(50vw,320px)] overflow-hidden truncate text-ellipsis whitespace-nowrap text-sm",title:n.text,children:n.text})]}),_=(0,t.jsx)("div",{className:"flex flex-col gap-2",children:(0,t.jsx)("div",{className:"flex items-center gap-2",children:(0,t.jsxs)("h4",{className:"font-medium",children:["ðŸ”Š ",k("preview_sample")]})})});return l&&0===o?(0,t.jsx)(L,{content:_,defaultOpen:!0,side:"top",align:"start",className:"min-w-[18rem]",borderClassName:"border-purple-500",stepKey:"discover-play-sample",children:C}):C});z.displayName="AudioSample";let I=s.forwardRef((e,s)=>{let{className:n,data:o,inner:l,handleUseVoice:c,isFirst:d,preventNavigation:u,isDashboard:h,...m}=e,p=l?"md:h-[6.55rem] md:w-[6.55rem]":"md:h-[7.25rem] md:w-[7.25rem]",f=(0,k.useMediaQuery)("(min-width: 768px)");return(0,t.jsx)(r.Card,{className:(0,a.cn)("group mb-3 rounded-xl",n),...m,children:(0,t.jsxs)(r.CardContent,{className:"flex flex-col p-4 md:p-4",children:[(0,t.jsxs)("div",{className:"flex flex-1",children:[(0,t.jsx)(i.Avatar,{className:(0,a.cn)("mr-3 h-16 w-16 rounded-lg md:mr-4","".concat(p)),children:(0,t.jsx)(i.AvatarImage,{src:(0,a.fetchImage)(o.cover_image,f?128:64),alt:o.title})}),(0,t.jsxs)("div",{className:"flex flex-1 flex-col",children:[(0,t.jsx)(r.CardTitle,{className:(0,a.cn)("max-md:text-base","".concat(f&&l?"mt-0":""),"".concat(l?"text-lg":"")),children:(0,t.jsx)(C.default,{href:h?"/app/m/".concat(o._id):"/m/".concat(o._id),children:o.title})}),(0,t.jsx)(U,{user:o.author.nickname,userId:o.author._id,avatar:o.author.avatar,time:o.created_at,tags:o.tags,samples:o.samples,lng:o.languages}),o.samples&&o.samples.length>0&&(0,t.jsx)("div",{className:"mt-2 flex flex-col space-y-2",children:o.samples.slice(0,3).map((e,s)=>(0,t.jsx)(z,{sample:e,index:s,isFirst:d},s))}),(0,t.jsx)("div",{className:"w-full flex-1"}),(0,t.jsx)(B,{className:"hidden md:flex",data:o,inner:l,handleUseVoice:c,isFirst:d,preventNavigation:u})]})]}),(0,t.jsx)(O,{data:o,handleUseVoice:c,isFirst:d,preventNavigation:u,isDashboard:h})]})})});I.displayName="VoiceCard"},678631,(e,t,s)=>{!function(t,s){if("function"==typeof define&&define.amd){let t;void 0!==(t=s())&&e.v(t)}else s()}(e.e,function(){"use strict";function s(e,t,s){var a=new XMLHttpRequest;a.open("GET",e),a.responseType="blob",a.onload=function(){o(a.response,t,s)},a.onerror=function(){console.error("could not download file")},a.send()}function a(e){var t=new XMLHttpRequest;t.open("HEAD",e,!1);try{t.send()}catch(e){}return 200<=t.status&&299>=t.status}function r(e){try{e.dispatchEvent(new MouseEvent("click"))}catch(s){var t=document.createEvent("MouseEvents");t.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),e.dispatchEvent(t)}}var i="object"==typeof window&&window.window===window?window:"object"==typeof self&&self.self===self?self:e.g.global===e.g?e.g:void 0,n=i.navigator&&/Macintosh/.test(navigator.userAgent)&&/AppleWebKit/.test(navigator.userAgent)&&!/Safari/.test(navigator.userAgent),o=i.saveAs||("object"!=typeof window||window!==i?function(){}:"download"in HTMLAnchorElement.prototype&&!n?function(e,t,n){var o=i.URL||i.webkitURL,l=document.createElement("a");l.download=t=t||e.name||"download",l.rel="noopener","string"==typeof e?(l.href=e,l.origin===location.origin?r(l):a(l.href)?s(e,t,n):r(l,l.target="_blank")):(l.href=o.createObjectURL(e),setTimeout(function(){o.revokeObjectURL(l.href)},4e4),setTimeout(function(){r(l)},0))}:"msSaveOrOpenBlob"in navigator?function(e,t,i){if(t=t||e.name||"download","string"!=typeof e){var n;navigator.msSaveOrOpenBlob((void 0===(n=i)?n={autoBom:!1}:"object"!=typeof n&&(console.warn("Deprecated: Expected third argument to be a object"),n={autoBom:!n}),n.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(e.type)?new Blob(["\uFEFF",e],{type:e.type}):e),t)}else if(a(e))s(e,t,i);else{var o=document.createElement("a");o.href=e,o.target="_blank",setTimeout(function(){r(o)})}}:function(e,t,a,r){if((r=r||open("","_blank"))&&(r.document.title=r.document.body.innerText="downloading..."),"string"==typeof e)return s(e,t,a);var o="application/octet-stream"===e.type,l=/constructor/i.test(i.HTMLElement)||i.safari,c=/CriOS\/[\d]+/.test(navigator.userAgent);if((c||o&&l||n)&&"undefined"!=typeof FileReader){var d=new FileReader;d.onloadend=function(){var e=d.result;e=c?e:e.replace(/^data:[^;]*;/,"data:attachment/file;"),r?r.location.href=e:location=e,r=null},d.readAsDataURL(e)}else{var u=i.URL||i.webkitURL,h=u.createObjectURL(e);r?r.location=h:location.href=h,r=null,setTimeout(function(){u.revokeObjectURL(h)},4e4)}});i.saveAs=o.saveAs=o,t.exports=o})}]);